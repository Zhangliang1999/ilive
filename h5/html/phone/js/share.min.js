var _shareTitle,_shareImg,_shareDesc,_shareTitle2,_shareImg2,_shareDesc2,sessionId,userIdTemp,liveEventIdTemp,url=window.location.href,appInterfaceBase=webBaseUrl+"/ilive",statisticBase="http://statistics.zb.tv189.com",wxshare={init:function(){createAPI(appInterfaceBase+"/app/wx/shareinfo.jspx",{roomId:Params.roomId}).then(function(e){if(0!==e.code){var s={shareUrl:url,cover:e.data.friendCircle.liveImg||"",title:e.data.friendCircle.liveTitle||"",content:e.data.friendCircle.liveDesc||""};TysxJsSdk.invokeJsApi("set_shareInfo",s,function(e){console.log(e)}),wxshare.share(e)}else layerOpen("share-err")})},share:function(e){_shareTitle=e.data.friendCircle.liveTitle,_shareImg=e.data.friendCircle.liveImg,_shareDesc=e.data.friendCircle.liveDesc,_shareTitle2=e.data.friendSingle.liveTitle,_shareImg2=e.data.friendSingle.liveImg,_shareDesc2=e.data.friendSingle.liveDesc,sessionId=e.sessionId,userIdTemp=$("input[name=userId]").val(),liveEventIdTemp=$("input[name=liveEventId]").val(),$("meta[name='description']").attr("content",e.data.friendCircle.liveDesc),createAPI(appInterfaceBase+"/app/wx/share.jspx",{shareUrl:url}).then(function(e){try{wx.config({debug:!1,appId:e.appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","showOptionMenu"]}),wx.ready(function(){wx.onMenuShareAppMessage({title:_shareTitle2,link:url,imgUrl:_shareImg2,desc:_shareDesc2,success:function(){$.ajax({url:statisticBase+"/statistic/service/user/share",type:"get",data:{userId:userIdTemp+"_"+sessionId,roomId:Params.roomId,type:4,liveEventId:liveEventIdTemp},async:!1,crossDomain:!0,dataType:"jsonp",jsonp:"jsoncallback",success:function(e){}})}}),wx.onMenuShareTimeline({title:_shareTitle,link:url,imgUrl:_shareImg,desc:_shareDesc,success:function(){$.ajax({url:statisticBase+"/statistic/service/user/share",type:"get",data:{userId:userIdTemp+"_"+sessionId,roomId:Params.roomId,type:4,liveEventId:liveEventIdTemp},async:!1,crossDomain:!0,dataType:"jsonp",jsonp:"jsoncallback",success:function(e){}});var e=userIdTemp;0!=e&&$.ajax({type:"GET",url:"http://"+tomcatBase+"/ilive/prize/share.jspx",dataType:"jsonp",jsonp:"callback",cache:!1,data:{terminalType:"h5",userId:e,roomId:Params.roomId},success:function(e){}})}})})}catch(e){alert(e)}}).catch(function(e){})}};