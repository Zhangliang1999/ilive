var arr=[];var num=0;var timer=1;$(document).ready(function(){$(document).delegate(".giftCon ul li","click",function(){$(this).addClass("giftactive").siblings().removeClass("giftactive")});$(".giftmask").click(function(){$(".giftMask").fadeOut(500)})});function openGiftIcon(){var a=$("input[name=userId]").val();if(a==0){if(confirm("是否进入登录？")){var b=$("input[name=roomId]").val();window.location.href="http://"+h5Base+"/phone/login.html?roomId="+b}else{layerOpen("不登录无法进行礼物操作")}}else{$(".giftMask").fadeIn(500)}}function saveUserGift(){var e=$("input[name=roomId]").val();var d=$("input[name=userId]").val();var c=$(".giftactive").attr("giftId");if(c==undefined||c==null){layerOpen("请选择赠送礼物")}else{var h=1;var a=$(".giftactive").attr("giftPrice");var g=parseFloat(a)*100;var f=$(".giftactive").attr("giftName");var b=f+"*"+h;wechatSweepUnifyTheOrder(1,b,g,c)}}function saveUserGiftPay(){var c=$("input[name=roomId]").val();var b=$("input[name=userId]").val();var a=$(".giftactive").attr("giftId");if(a==undefined||a==null){layerOpen("请选择赠送礼物")}else{var d=1;$.ajax({type:"GET",url:"http://"+tomcatBase+"/ilive/gift/save/userGift.jspx",dataType:"jsonp",jsonp:"callback",cache:false,data:{roomId:c,terminalType:"h5",userId:b,giftId:a,giftNumber:d},success:function(e){if(e.code==1){console.log("成功");$(".giftMask").fadeOut(500)}else{layerOpen(e.message)}}})}}function giveGift(){console.log("arr的长度=="+arr.length);if(closegift){return}if(arr.length<1){setTimeout(function(){$(".giftLeft").eq(0).remove()},timer)}else{num++;if(arr[0].code==0){var a="<div class='giftone'><span class='personname'>"+arr[0].userName+"</span>赠送了 <img src='"+arr[0].giftImage+"'/>x1</div>"}else{if(arr[0].code==1){var a="<div class='giftone'><span class='personname'>"+arr[0].userName+"</span>打赏了   <span>"+arr[0].rewardsPrice+"</span>元</div>"}else{if(arr[0].code==2){var a="<div class='giftone'><span class='personname'>"+arr[0].welcomeLanguage+"</span></div>"}}}$(".giftLeft").append(a);arr.splice(0,1);gift()}}var margintop=-40;var time=null;var time1=null;var closegift=false;function gift(){var c=$(".giftLeft");var a=c.children("div");c.show();for(var b=0;b<a.length;b++){clearInterval(time);time=setInterval(function(){c.find("div").first().addClass("myopacityout").animate({marginTop:margintop},500,function(){$(this).remove()}).next().addClass("myopacity")},1000)}clearInterval(time1);time1=setInterval(function(){if(c.children("div").length<1){c.hide();clearInterval(time1)}},10)}$("#giftLeftclose").on("click",function(){$("#giftLeft").css("display","none");closegift=true});