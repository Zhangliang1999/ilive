var krpanoplugin=function(){function ai(b){return"boolean"==typeof b?b:0<="yesontrue1".indexOf(String(b).toLowerCase())}function f(e){if(e&&aY&&az){var h=aY.timertick,g=0;0==ah&&(ah=h);var c=h-ah|0;ah=h;"wheel"==e.type?g=e.deltaY:"mousewheel"==e.type?g=-e.wheelDelta:"DOMMouseScroll"==e.type&&(g=e.detail);g=-g;500<c?ag=1==e.deltaMode||0==g%20?0:1:66>c&&0==ag&&0!=g%40&&6<Math.abs(g)&&(ag=1);e.preventDefault();e.stopPropagation();0!=g&&(0==ag?g=0>g?-5:5:(g/=20,-10>g?g=-10:10<g&&(g=10)),1==aW?af(g*ay,0):2==aW?af(0,g*aK):3==aW&&af(0,g*aK))}}function aT(k,q,n,h,p){var r=null;p=(!0===p?"remove":"add")+"EventListener";var m=ae.browser.events;if(m.touch&&("down"==q?r=m.touchstart:"move"==q?r=m.touchmove:"up"==q&&(r=m.touchend),ae.ie&&0==m.mouse&&("over"==q?r=m.pointerover?m.pointerover:"MSPointerOver":"out"==q&&(r=m.pointerout?m.pointerout:"MSPointerOut")),r)){k[p](r,n,h)}if(m.mouse&&("down"==q?r="mousedown":"move"==q?r="mousemove":"up"==q?r="mouseup":"over"==q?r="mouseover":"out"==q&&(r="mouseout"),r)){k[p](r,n,h)}}function a4(){if(a3){var b=a3.sprite.parentNode;b&&(b=b.kobject)&&(b.maskchildren=!0,b.poschanged&&b.updatepluginpos(),a3.poschanged&&a3.updatepluginpos(),aG=b,aS=b.pixelwidth,aQ=b.pixelheight,isNaN(aS)&&(aS=0),isNaN(aQ)&&(aQ=0),av=0<aS||0<aQ)}}function au(){a1=Number(a3.x);a2=Number(a3.y);isNaN(aA)&&(a1=0);isNaN(a)&&(a2=0)}function at(c){c=void 0===c?!1:c;1==(aW&1)?a3.x!=a1&&(a3.x=a1,c=!0):a1=0;2==(aW&2)?a3.y!=a2&&(a3.y=a2,c=!0):a2=0;!av||ad[0]==aP&&ad[1]==aN||(ad[0]=aP,ad[1]=aN,c=!0);if(c&&a3&&av){c=aS-aP;var g=aQ-aN,e=a1,b=a2;isNaN(e)&&(e=0);isNaN(b)&&(b=0);e+=c*aV;b+=g*aU;a3.woverflow=-c;a3.hoverflow=-g;a3.loverflow=Math.round((-e+ar*c)*ay);a3.roverflow=Math.round((+e-(1-ar)*c)*ay);a3.toverflow=Math.round((-b+aq*g)*aK);a3.boverflow=Math.round((+b-(1-aq)*g)*aK);a3.onscroll&&aY.call(a3.onscroll,a3)}}function aJ(b){for(;0<aI.length&&!(100>=b-aI[0].time);){aI.shift()}}function ap(){a4();var b=String(a3.align).toLowerCase();if(""==b||"null"==b){b="lefttop"}aK=ay=1;aU=aV=0.5;aq=ar=0;0<=b.indexOf("left")&&(aV=ar=0,ay=1);0<=b.indexOf("top")&&(aU=aq=0,aK=1);0<=b.indexOf("right")&&(ar=1,aV=0,ay=-1);0<=b.indexOf("bottom")&&(aq=1,aU=0,aK=-1)}function aC(e){ap();aI=[];if(0==ao){aL=!1}else{aT(window,"up",aH,!0);aT(window,"move",aB,!0);var g=aY.stagescale,c=e.changedTouches&&0<e.changedTouches.length?e.changedTouches[0]:e;e=c.pageX/g;g=c.pageY/g;aL=!1;ab=e;o=g;return !1}}function j(b){(void 0===b.pointerType||4==b.pointerType||"mouse"==b.pointerType)&&d&&(ap(),0!=av&&(b=aQ-aN,0>aS-aP||0>b))&&(an=!0,aT(a3.sprite,"move",aM,!0),aT(a3.sprite,"out",aD,!0))}function aM(b){an&&0==aL&&aG&&(b=aG.getmouse(),l(b.x/aS*a3.pixelwidth,b.y/aQ*a3.pixelheight,!0))}function aD(b){aT(a3.sprite,"move",aM,!0,!0);aT(a3.sprite,"out",aD,!0,!0);an=!1}function aB(e){if(0==ao){return aL=!1}var g=aY.stagescale,c=e.changedTouches&&0<e.changedTouches.length?e.changedTouches[0]:e;e=c.pageX/g;g=c.pageY/g;0==aL&&(aW&1&&5<Math.abs(e-ab)||aW&2&&5<Math.abs(g-o))&&(ax&&(a0=aZ=0,ax=!1),null!=aX&&(clearInterval(aX),aX=null),aL=!0,an=!1,ab=e,o=g,au(),aA=a1,a=a2);aL&&(c=aY.timertick,aJ(c),aI.push({time:c,x:e,y:g}),a1=aA+(e-ab)*ay,a2=a+(g-o)*aK,e=-(aP-aS),g=-(aN-aQ),a1+=e*aV,a2+=g*aU,c=1/(1+aw*aw),a1=0<e?a1-(a1-e*aV)*c:a1-(0<a1?a1:a1<e?a1-e:0)*c,a2=0<g?a2-(a2-g*aU)*c:a2-(0<a2?a2:a2<g?a2-g:0)*c,a1-=e*aV,a2-=g*aU,at());return !1}function aH(g){aT(window,"up",aH,!0,!0);aT(window,"move",aB,!0,!0);if(0==ao){a0=aZ=0,aL=!1}else{if(aL){aJ(aY.timertick);if(1<aI.length){g=aI[0];var h=aI[aI.length-1],e=h.y-g.y,k=(h.time-g.time)*i;aZ=(h.x-g.x)/k*ay;a0=e/k*aK}else{a0=aZ=0}aX=setInterval(am,1000/60);aL=!1}}}function aE(){setTimeout(function(){a4();at(!0);null==aX&&(aX=setInterval(am,1000/60))},100)}function ac(){a3&&(a4(),au(),at(!0))}function am(){a1+=aZ;a2+=a0;aZ*=al;a0*=al;var g=0,h=0,c=-(aP-aS),e=-(aN-aQ);a1+=c*aV;a2+=e*aU;0<c?g=a1-c*aV:ax?g=a1-s:a1<c?g=a1-c:0<a1&&(g=a1);0.1>g*g&&(g=0);0<e?h=a2-e*aU:ax?h=a2-aO:a2<e?h=a2-e:0<a2&&(h=a2);0.1>h*h&&(h=0);a1-=c*aV;a2-=e*aU;0==(aW&1)&&(aZ=g=0);0==(aW&2)&&(a0=h=0);0!=g&&(g*=-1,a1+=g*(1-aw),aZ=0>=g*aZ?aZ+g*ak:g*aj,aZ*=aw);0!=h&&(h*=-1,a2+=h*(1-aw),a0=0>=h*a0?a0+h*ak:h*aj,a0*=aw);0==g&&0==h&&0.05>Math.sqrt(aZ*aZ+a0*a0)&&(ax=!1,a0=aZ=0,clearInterval(aX),aX=null);at()}function l(h,c,m){ap();au();if(0==av){setTimeout(function(){l(h,c,m)},10)}else{h=Number(h);isNaN(h)&&(h=0);c=Number(c);isNaN(c)&&(c=0);var e=aS-aP,k=aQ-aN;h=ar*aP+h*ay;c=aq*aN+c*aK;h*=-1;c*=-1;h+=aS/2;0<h&&(h=0);h<e&&(h=e);c+=aQ/2;0<c&&(c=0);c<k&&(c=k);!0===m?(ax=!0,s=h,aO=c,null==aX&&(aX=setInterval(am,1000/60))):(e=-(aP-aS),k=-(aN-aQ),h=0>e?h-e*aV:0,c=0>k?c-k*aU:0,a1=h,a2=c,at())}}function aR(e,c){l(e,c,!0)}function aF(){aL&&(aT(window,"up",aH,!0,!0),aT(window,"move",aB,!0,!0));null!=aX&&(clearInterval(aX),aX=null);an=aL=!1;aI=[];a0=aZ=0;ax=!1;au()}function af(g,c){ax=!1;g=Number(g);isNaN(g)&&(g=0);c=Number(c);isNaN(c)&&(c=0);ap();au();if(0!=av){var m=aS-aP,e=aQ-aN,h=!1;0>m&&(a1+=m*aV,0<g&&0>a1?(h=!0,aZ+=g):0>g&&a1>m&&(h=!0,aZ+=g),a1-=m*aV);0>e&&(a2+=e*aU,0<c&&0>a2?(h=!0,a0+=c):0>c&&a2>e&&(h=!0,a0+=c),a2-=e*aU);h&&null==aX&&(aX=setInterval(am,1000/60))}}var aY=null,a3=null,ae=null,aW=3,aP=0,aN=0,ad=[0,0],av=!1,aG=null,aS=0,aQ=0,ax=!1,s=0,aO=0,ay=1,aK=1,aV=0,aU=0,ar=0,aq=0,aw=1,al=0.95,ak=0.08,aj=0.15,i=1/15,ao=!0,az=!0,aL=!1,ab=0,o=0,a1=0,a2=0,aA=0,a=0,aX=null,aI=[],aZ=0,a0=0,an=!1,d=!1;this.registerplugin=function(b,h,g){aY=b;a3=g;"1.19">aY.version?(aY.trace(3,"Scrollarea Plugin - too old krpano version (min. version 1.19)"),a3=aY=null):(ae=aY.device,a3.registerattribute("direction","all",function(c){c=String(c).toLowerCase();aW=0;aW|=1*(0<=c.indexOf("h"));aW|=2*(0<=c.indexOf("v"));aW|=3*(0<=c.indexOf("all"))},function(){return 3==(aW&3)?"all":1==(aW&1)?"h":"v"}),a3.registerattribute("overscroll",aw,function(c){aw=0>c?0:1<c?1:c},function(){return aw}),a3.registerattribute("friction",al,function(c){al=Number(c)},function(){return al}),a3.registerattribute("acceleration",ak,function(c){ak=Number(c)},function(){return ak}),a3.registerattribute("returnacceleration",aj,function(c){aj=Number(c)},function(){return aj}),a3.registerattribute("momentum",i,function(c){i=Number(c)},function(){return i}),a3.registerattribute("onscroll",null),a3.registerattribute("woverflow",0),a3.registerattribute("hoverflow",0),a3.registerattribute("loverflow",0),a3.registerattribute("roverflow",0),a3.registerattribute("toverflow",0),a3.registerattribute("boverflow",0),a3.registerattribute("draggable",!0,function(c){ao=ai(c)},function(){return ao}),a3.registerattribute("mwheel",!0,function(c){az=ai(c)},function(){return az}),a3.registerattribute("onhover_autoscrolling",!1,function(c){d=ai(c)},function(){return d}),a3.registerattribute("csshardwareacceleration","auto"),a3.setcenter=l,a3.scrolltocenter=aR,a3.stopscrolling=aF,a3.scrollby=af,a3.update=ac,1==ai(a3.csshardwareacceleration)&&(a3.sprite.style[ae.browser.css.transform+"Style"]="preserve-3d"),a3.sprite.addEventListener("DOMMouseScroll",f,!0),a3.sprite.addEventListener("mousewheel",f,!0),a3.sprite.addEventListener("wheel",f,!0),aT(a3.sprite,"down",aC,!0),aT(a3.sprite,"over",j,!0),aY.set("events["+a3.name+"_scrollarea].keep",!0),aY.set("events["+a3.name+"_scrollarea].onresize",aE))};var ah=0,ag=0;this.onresize=function(e,c){if(!aY){return !1}aP=e;aN=c;var n;ax=!1;ap();au();if(0==av){n=!1}else{n=aS-aP;var m=aQ-aN,k=!1;a1+=n*aV;if(0>n){if(0>a1||a1>n){k=!0}}else{0!=a1&&(k=!0)}a1-=n*aV;a2+=m*aU;if(0>m){if(0>a2||a2>m){k=!0}}else{0!=a2&&(k=!0)}a2-=m*aU;k&&null==aX&&(aX=setInterval(am,1000/60));n=k}0==n&&at(!0);return !1};this.unloadplugin=function(){aY&&a3&&(aY.set("events["+a3.name+"_scrollarea].name",null),null!=aX&&(clearInterval(aX),aX=null),aT(a3.sprite,"down",aC,!0,!0),aT(a3.sprite,"over",j,!0,!0));aY=a3=null}};