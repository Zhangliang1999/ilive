var krpanoplugin=function(){function r(d,i){function g(o){return"rgb("+(o>>16&255)+","+(o>>8&255)+","+(o&255)+")"}var k=document.createElementNS("http://www.w3.org/2000/svg","svg");k.setAttribute("width",d);k.setAttribute("height",i);k.style.position="absolute";k.style.left="0px";k.style.top="0px";var b=document.createElementNS("http://www.w3.org/2000/svg","path");k.appendChild(b);var j={};j.svg=k;j.path=b;j.setstyle=function(M,K,s,L,o){b.setAttribute("stroke",g(M));b.setAttribute("stroke-width",K);b.setAttribute("stroke-opacity",s);b.setAttribute("fill",g(L));b.setAttribute("fill-opacity",o)};j.drawpie=function(O,N,K,M,L){var o,P;M>L&&(o=L,L=M,M=o);M=M*Math.PI/180;L=L*Math.PI/180;P=L-M;o=(M+L)/2;var s=P>Math.PI?1:0;P>=2*Math.PI&&(P=2*Math.PI-0.01);M=o-P/2;L=o+P/2;o=O+K*Math.sin(M);M=N-K*Math.cos(M);P=O+K*Math.sin(L);L=N-K*Math.cos(L);b.setAttribute("d","M "+O+","+N+" L "+o+","+M+" A "+K+","+K+" 0 "+s+" 1 "+P+","+L+" Z")};return j}function c(b){n=!0;J(b);B.mouse&&(window.addEventListener("mousemove",J,!0),window.addEventListener("mouseup",H,!0));B.touch&&(window.addEventListener(B.touchmove,J,!0),window.addEventListener(B.touchcancel,H,!0),window.addEventListener(B.touchend,H,!0))}function H(b){B.mouse&&(window.removeEventListener("mousemove",J,!0),window.removeEventListener("mouseup",H,!0));B.touch&&(window.removeEventListener(B.touchmove,J,!0),window.removeEventListener(B.touchcancel,H,!0),window.removeEventListener(B.touchend,H,!0))}function J(g){if(null==y){H(g)}else{if(null!=D){g&&(g.preventDefault(),g.stopImmediatePropagation(),g.stopPropagation());var i,d=i=0,b=D.svg.parentNode.getBoundingClientRect();B.touch?(g=g.changedTouches?g.changedTouches:[g],0<g.length&&(d=g[0],i=Math.round(d.clientX-b.left),d=Math.round(d.clientY-b.top))):(i=Math.round(g.clientX-b.left),d=Math.round(g.clientY-b.top));i=180*Math.atan2(d-0.5*e*y.stagescale,i-0.5*h*y.stagescale)/Math.PI;i-=a;if(1==n){p=i-Number(y.view.hlookat),n=!1}else{for(i-=p;180<i;){i-=360}for(;-180>i;){i+=360}y.view.hlookat=i}F=!0}}}function v(){var g=I/2*y.stagescale;2000<g&&(g=2000);var d=Math.ceil(2*g),i=2+2*f+d;if(i!=A){A=i;var b=D.svg;b.setAttribute("width",i);b.setAttribute("height",i);b.style.left=(d-i>>1)+"px";b.style.top=(d-i>>1)+"px";F=!0}d=a+t-0+y.view.hlookat;b=y.view.hfov;x&&(b=-b);w&&w.sprite&&(w.sprite.style.pointerEvents="none");var j=D.path.style;j.pointerEvents=w.enabled?"visiblePainted":"none";j.cursor=w.handcursor?"pointer":"default";if(0.01<Math.abs(d-E)||0.02<Math.abs(b-l)){E=d,l=b,F=!0}F&&(F=!1,D.setstyle(C,f,G,m,u),D.drawpie(i/2-0.5,i/2-0.5,g,d-0.5*b,d+0.5*b))}var y=null,w=null,z=null,B=null,D=null,I=256,h=256,e=256,a=0,t=90,x=!1,m=16777215,C=16777215,u=0.5,G=0.3,f=0,n=!1,p=null,F=!0,q=null,A=-1,E=0,l=0;this.registerplugin=function(g,b,d){y=g;w=d;"1.18">y.version?(y.trace(3,"Radar Plugin - too old krpano version (min. 1.18)"),w=y=null):(z=y.device,B=z.browser.events,w.registerattribute("heading",0,function(i){a=Number(i);F=!0},function(){return a}),w.registerattribute("headingoffset",90,function(i){t=Number(i);F=!0},function(){return t}),w.registerattribute("invert",!1,function(i){x="true"==String(i).toLowerCase();F=!0},function(){return x}),w.registerattribute("fillcolor",16777215,function(i){m=parseInt(i);F=!0},function(){return m}),w.registerattribute("linecolor",16777215,function(i){C=parseInt(i);F=!0},function(){return C}),w.registerattribute("fillalpha",0.5,function(i){u=Number(i);F=!0},function(){return u}),w.registerattribute("linealpha",0.3,function(i){G=Number(i);F=!0},function(){return G}),w.registerattribute("linewidth",0,function(i){f=Number(i);F=!0},function(){return f}),w.registercontentsize(I,I),D=r(I,I),w._assignEvents(D.path),D.path.kobject=w,w.sprite.style.pointerEvents="none",w.sprite.appendChild(D.svg),B.mouse&&D.path.addEventListener("mousedown",c,!0),B.touch&&D.path.addEventListener(B.touchstart,c,!0),q=setInterval(v,1000/30))};this.unloadplugin=function(){if(y&&w){clearInterval(q);try{D.path.kobject=null,w.sprite.removeChild(D.svg)}catch(b){}y=w=null}};this.onresize=function(b,d){h=b;e=d;I=Math.max(b,d);F=!0;v();D.path.style[z.browser.css.transform]="scale("+(b/I).toFixed(6)+","+(d/I).toFixed(6)+")";return !1}};