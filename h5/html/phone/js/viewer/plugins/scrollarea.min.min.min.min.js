var krpanoplugin=function(){function U(a){return"boolean"==typeof a?a:0<="yesontrue1".indexOf(String(a).toLowerCase())}function e(f){if(f&&A&&ac){var a=A.timertick,d=0;0==V&&(V=a);var i=a-V|0;V=a;"wheel"==f.type?d=f.deltaY:"mousewheel"==f.type?d=-f.wheelDelta:"DOMMouseScroll"==f.type&&(d=f.detail);d=-d;500<i?Y=1==f.deltaMode||0==d%20?0:1:66>i&&0==Y&&0!=d%40&&6<Math.abs(d)&&(Y=1);f.preventDefault();f.stopPropagation();0!=d&&(0==Y?d=0>d?-5:5:(d/=20,-10>d?d=-10:10<d&&(d=10)),1==E?aa(d*ae,0):2==E?aa(0,d*ad):3==E&&aa(0,d*ad))}}function K(d,l,f,i,o){var j=null;o=(!0===o?"remove":"add")+"EventListener";var a=p.browser.events;if(a.touch&&("down"==l?j=a.touchstart:"move"==l?j=a.touchmove:"up"==l&&(j=a.touchend),p.ie&&0==a.mouse&&("over"==l?j=a.pointerover?a.pointerover:"MSPointerOver":"out"==l&&(j=a.pointerout?a.pointerout:"MSPointerOut")),j)){d[o](j,f,i)}if(a.mouse&&("down"==l?j="mousedown":"move"==l?j="mousemove":"up"==l?j="mouseup":"over"==l?j="mouseover":"out"==l&&(j="mouseout"),j)){d[o](j,f,i)}}function y(){if(B){var a=B.sprite.parentNode;a&&(a=a.kobject)&&(a.maskchildren=!0,a.poschanged&&a.updatepluginpos(),B.poschanged&&B.updatepluginpos(),ap=a,M=a.pixelwidth,c=a.pixelheight,isNaN(M)&&(M=0),isNaN(c)&&(c=0),aj=0<M||0<c)}}function ak(){F=Number(B.x);C=Number(B.y);isNaN(v)&&(F=0);isNaN(T)&&(C=0)}function am(i){i=void 0===i?!1:i;1==(E&1)?B.x!=F&&(B.x=F,i=!0):F=0;2==(E&2)?B.y!=C&&(B.y=C,i=!0):C=0;!aj||r[0]==g&&r[1]==m||(r[0]=g,r[1]=m,i=!0);if(i&&B&&aj){i=M-g;var d=c-m,f=F,a=C;isNaN(f)&&(f=0);isNaN(a)&&(a=0);f+=i*G;a+=d*I;B.woverflow=-i;B.hoverflow=-d;B.loverflow=Math.round((-f+an*i)*ae);B.roverflow=Math.round((+f-(1-an)*i)*ae);B.toverflow=Math.round((-a+ao*d)*ad);B.boverflow=Math.round((+a-(1-ao)*d)*ad);B.onscroll&&A.call(B.onscroll,B)}}function af(a){for(;0<ai.length&&!(100>=a-ai[0].time);){ai.shift()}}function aq(){y();var a=String(B.align).toLowerCase();if(""==a||"null"==a){a="lefttop"}ad=ae=1;I=G=0.5;ao=an=0;0<=a.indexOf("left")&&(G=an=0,ae=1);0<=a.indexOf("top")&&(I=ao=0,ad=1);0<=a.indexOf("right")&&(an=1,G=0,ae=-1);0<=a.indexOf("bottom")&&(ao=1,I=0,ad=-1)}function q(d){aq();ai=[];if(0==ar){ab=!1}else{K(window,"up",al,!0);K(window,"move",t,!0);var a=A.stagescale,f=d.changedTouches&&0<d.changedTouches.length?d.changedTouches[0]:d;d=f.pageX/a;a=f.pageY/a;ab=!1;x=d;H=a;return !1}}function N(a){(void 0===a.pointerType||4==a.pointerType||"mouse"==a.pointerType)&&h&&(aq(),0!=aj&&(a=c-m,0>M-g||0>a))&&(at=!0,K(B.sprite,"move",Z,!0),K(B.sprite,"out",n,!0))}function Z(a){at&&0==ab&&ap&&(a=ap.getmouse(),L(a.x/M*B.pixelwidth,a.y/c*B.pixelheight,!0))}function n(a){K(B.sprite,"move",Z,!0,!0);K(B.sprite,"out",n,!0,!0);at=!1}function t(d){if(0==ar){return ab=!1}var a=A.stagescale,f=d.changedTouches&&0<d.changedTouches.length?d.changedTouches[0]:d;d=f.pageX/a;a=f.pageY/a;0==ab&&(E&1&&5<Math.abs(d-x)||E&2&&5<Math.abs(a-H))&&(ag&&(J=z=0,ag=!1),null!=D&&(clearInterval(D),D=null),ab=!0,at=!1,x=d,H=a,ak(),v=F,T=C);ab&&(f=A.timertick,af(f),ai.push({time:f,x:d,y:a}),F=v+(d-x)*ae,C=T+(a-H)*ad,d=-(g-M),a=-(m-c),F+=d*G,C+=a*I,f=1/(1+ah*ah),F=0<d?F-(F-d*G)*f:F-(0<F?F:F<d?F-d:0)*f,C=0<a?C-(C-a*I)*f:C-(0<C?C:C<a?C-a:0)*f,F-=d*G,C-=a*I,am());return !1}function al(f){K(window,"up",al,!0,!0);K(window,"move",t,!0,!0);if(0==ar){J=z=0,ab=!1}else{if(ab){af(A.timertick);if(1<ai.length){f=ai[0];var d=ai[ai.length-1],i=d.y-f.y,a=(d.time-f.time)*b;z=(d.x-f.x)/a*ae;J=i/a*ad}else{J=z=0}D=setInterval(P,1000/60);ab=!1}}}function X(){setTimeout(function(){y();am(!0);null==D&&(D=setInterval(P,1000/60))},100)}function u(){B&&(y(),ak(),am(!0))}function P(){F+=z;C+=J;z*=Q;J*=Q;var d=0,a=0,i=-(g-M),f=-(m-c);F+=i*G;C+=f*I;0<i?d=F-i*G:ag?d=F-w:F<i?d=F-i:0<F&&(d=F);0.1>d*d&&(d=0);0<f?a=C-f*I:ag?a=C-k:C<f?a=C-f:0<C&&(a=C);0.1>a*a&&(a=0);F-=i*G;C-=f*I;0==(E&1)&&(z=d=0);0==(E&2)&&(J=a=0);0!=d&&(d*=-1,F+=d*(1-ah),z=0>=d*z?z+d*R:d*S,z*=ah);0!=a&&(a*=-1,C+=a*(1-ah),J=0>=a*J?J+a*R:a*S,J*=ah);0==d&&0==a&&0.05>Math.sqrt(z*z+J*J)&&(ag=!1,J=z=0,clearInterval(D),D=null);am()}function L(f,j,a){aq();ak();if(0==aj){setTimeout(function(){L(f,j,a)},10)}else{f=Number(f);isNaN(f)&&(f=0);j=Number(j);isNaN(j)&&(j=0);var i=M-g,d=c-m;f=an*g+f*ae;j=ao*m+j*ad;f*=-1;j*=-1;f+=M/2;0<f&&(f=0);f<i&&(f=i);j+=c/2;0<j&&(j=0);j<d&&(j=d);!0===a?(ag=!0,w=f,k=j,null==D&&(D=setInterval(P,1000/60))):(i=-(g-M),d=-(m-c),f=0>i?f-i*G:0,j=0>d?j-d*I:0,F=f,C=j,am())}}function O(a,d){L(a,d,!0)}function W(){ab&&(K(window,"up",al,!0,!0),K(window,"move",t,!0,!0));null!=D&&(clearInterval(D),D=null);at=ab=!1;ai=[];J=z=0;ag=!1;ak()}function aa(f,j){ag=!1;f=Number(f);isNaN(f)&&(f=0);j=Number(j);isNaN(j)&&(j=0);aq();ak();if(0!=aj){var a=M-g,i=c-m,d=!1;0>a&&(F+=a*G,0<f&&0>F?(d=!0,z+=f):0>f&&F>a&&(d=!0,z+=f),F-=a*G);0>i&&(C+=i*I,0<j&&0>C?(d=!0,J+=j):0>j&&C>i&&(d=!0,J+=j),C-=i*I);d&&null==D&&(D=setInterval(P,1000/60))}}var A=null,B=null,p=null,E=3,g=0,m=0,r=[0,0],aj=!1,ap=null,M=0,c=0,ag=!1,w=0,k=0,ae=1,ad=1,G=0,I=0,an=0,ao=0,ah=1,Q=0.95,R=0.08,S=0.15,b=1/15,ar=!0,ac=!0,ab=!1,x=0,H=0,F=0,C=0,v=0,T=0,D=null,ai=[],z=0,J=0,at=!1,h=!1;this.registerplugin=function(a,d,f){A=a;B=f;"1.19">A.version?(A.trace(3,"Scrollarea Plugin - too old krpano version (min. version 1.19)"),B=A=null):(p=A.device,B.registerattribute("direction","all",function(i){i=String(i).toLowerCase();E=0;E|=1*(0<=i.indexOf("h"));E|=2*(0<=i.indexOf("v"));E|=3*(0<=i.indexOf("all"))},function(){return 3==(E&3)?"all":1==(E&1)?"h":"v"}),B.registerattribute("overscroll",ah,function(i){ah=0>i?0:1<i?1:i},function(){return ah}),B.registerattribute("friction",Q,function(i){Q=Number(i)},function(){return Q}),B.registerattribute("acceleration",R,function(i){R=Number(i)},function(){return R}),B.registerattribute("returnacceleration",S,function(i){S=Number(i)},function(){return S}),B.registerattribute("momentum",b,function(i){b=Number(i)},function(){return b}),B.registerattribute("onscroll",null),B.registerattribute("woverflow",0),B.registerattribute("hoverflow",0),B.registerattribute("loverflow",0),B.registerattribute("roverflow",0),B.registerattribute("toverflow",0),B.registerattribute("boverflow",0),B.registerattribute("draggable",!0,function(i){ar=U(i)},function(){return ar}),B.registerattribute("mwheel",!0,function(i){ac=U(i)},function(){return ac}),B.registerattribute("onhover_autoscrolling",!1,function(i){h=U(i)},function(){return h}),B.registerattribute("csshardwareacceleration","auto"),B.setcenter=L,B.scrolltocenter=O,B.stopscrolling=W,B.scrollby=aa,B.update=u,1==U(B.csshardwareacceleration)&&(B.sprite.style[p.browser.css.transform+"Style"]="preserve-3d"),B.sprite.addEventListener("DOMMouseScroll",e,!0),B.sprite.addEventListener("mousewheel",e,!0),B.sprite.addEventListener("wheel",e,!0),K(B.sprite,"down",q,!0),K(B.sprite,"over",N,!0),A.set("events["+B.name+"_scrollarea].keep",!0),A.set("events["+B.name+"_scrollarea].onresize",X))};var V=0,Y=0;this.onresize=function(f,j){if(!A){return !1}g=f;m=j;var i;ag=!1;aq();ak();if(0==aj){i=!1}else{i=M-g;var a=c-m,d=!1;F+=i*G;if(0>i){if(0>F||F>i){d=!0}}else{0!=F&&(d=!0)}F-=i*G;C+=a*I;if(0>a){if(0>C||C>a){d=!0}}else{0!=C&&(d=!0)}C-=a*I;d&&null==D&&(D=setInterval(P,1000/60));i=d}0==i&&am(!0);return !1};this.unloadplugin=function(){A&&B&&(A.set("events["+B.name+"_scrollarea].name",null),null!=D&&(clearInterval(D),D=null),K(B.sprite,"down",q,!0,!0),K(B.sprite,"over",N,!0,!0));A=B=null}};