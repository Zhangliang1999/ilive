<!DOCTYPE html>
<html>
<head lang="en">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>直播间</title>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; chrset=utf-8" />
<meta
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
	name="viewport" />
<#include "/bvRadio/head.html"/> <#include
"/bvRadio/lightGallery.html"/> <#assign noCss=1/> <#include
"/bvRadio/uploadHead.html"/> <#include "/bvRadio/colorPickerHead.html"/>
<link rel="stylesheet" href="${base}/res/bvRadio/css/bootstrap.min.css" />
<link href='${base}/res/bvRadio/css/chats.css' media='all'
	rel='stylesheet' type='text/css' />
<link rel="stylesheet" href="${base}/res/bvRadio/css/newheader.css" />
<link rel="stylesheet" href="${base}/res/bvRadio/css/newleft.css" />
<link rel="stylesheet" href="${base}/res/bvRadio/css/zbj.css" />
<style>
.btn-switch {
	width: 36px;
	height: 18px;
	border-radius: 100px;
	position: relative;
	float: left;
	margin-top: 8px;
	margin-left: 10px;
	cursor: pointer;
}

.btn-switch2 {
	width: 18px;
	height: 18px;
	border-radius: 50px;
	position: absolute;
}

.open1 {
	background: #bfbfbf;
}

.open2 {
	background: #f6f6f6;
}

.open2 {
	right: 0px;
}

.close1 {
	background: #d81e06;
	border: 2px solid #ddd;
}

.close2 {
	left: 0px;
	top: -2px;
	background: #f6f6f6;
	border: 1px solid #f6f6f6;
}
video{
	max-width:300px!important;
	max-height:300px!important;
}
.some-class{
	background:url(./res/bvRadio/img/tuipian.png)
}
</style>
<script type="text/javascript">



function autoCheck(){
	
		var autoCheck = $("#autoCheck").val();
		if(autoCheck==0){
			var checkIntervalTime = 5;
			$("#liveDiv div[id^='msgDiv_'].unchecked").each(function(index,element){
				try {
					var nowDate = new Date();
					var createTime = $(element).find("input.createTime").val();
					var createDate = new Date(createTime);
					if((createDate.getTime()+checkIntervalTime*1000)<nowDate.getTime()){
						var msgId = $(element).attr("id").replace("msgDiv_","");
						checkInteractMessage(msgId);
					}
				} catch (e) {
				}
			});
		}
		setTimeout("autoCheck()", 1000);
	}
	
 		function getMsg(){
			var autoCheck = $("#autoCheck").val();
			var autoScroll = $("#autoScroll").val();
		
			/* var liveScrollTop = $("#liveDiv").scrollTop();
			var livScrollTop = $("#livDiv").scrollTop(); */
		 	var yourself="${topUser.username}"; 
		 	
			$.ajax({
				type : 'POST',
				url : "v_new_list.do",
				data : {
					liveId : ${liveId!0},
				},
				success : function(data, textStatus) {
					if (data.status == 1) {
						
					var msgList = data.data;
					for(var i=0; i<msgList.length; i++){
						try {
							var msg = msgList[i];
							var msgId = msg.msgId;
							var liveMsgType = msg.liveMsgType;
							var checked = msg.checked;
							var senderName = msg.senderName;
							var content = msg.content;
							var senderImage = msg.senderImage;
							var images = msg.images;
							var msgType = msg.msgType;
							var fontColor = msg.fontColor;
							var createTime = msg.createTime;
							var update = msg.update;
							var deleted = msg.deleted;
							var checked = msg.checked;
							//是删除
							if (deleted == 1) {
								$("#msgDiv_"+msgId).remove();
								continue;
							}
							if(liveMsgType==2){   
								// 聊天
								var innerHTML = "";
								innerHTML += "<div class=\"feed-element p-19 border-bottom-ccc\" id=\"msgDiv_"+msgId+"\">";
								innerHTML += "<a class=\"pull-left\">";
								if(null!=senderImage){
								innerHTML += "<img alt=\"image\" class=\"img-circle\" src="+senderImage+">";
								}else{
								innerHTML += "<img alt=\"image\" class=\"img-circle\" src=\"/bvRadioILive/res/bvRadio/img/u768.png\">";
								}
								
								innerHTML += "</a>";
								innerHTML += " <div class=\"media-body \">";
								innerHTML += "<p><strong class=\"pull-left\">"+senderName+"</strong><span class=\"graytitle\">";
								if(yourself==senderName){
										innerHTML += "官方";
									}else{
										innerHTML += "网友";
									}
								innerHTML += "</span><span class=\"zhiding\">顶</span></p>";
								innerHTML += "<p class=\"text-muted\">";
								if(msgType==1){
									innerHTML +=content
								}else{
									innerHTML +="邀请您参加活动，活动的地址是:http://47.100.62.168:8484/bvRadioBBS/activity/v_share.jspx?activityId="+content
								}
								innerHTML += "</p>";
								
								innerHTML +="<div class=\"col-lg-9 pull-right text-right\">"
								if(!checked){
								innerHTML += "<a class=\"btn btn-default\" onclick=\"checkInteractMessage("+msgId+")\">通过</a>";
								}
								innerHTML += "<a class=\"btn btn-default\" onclick=\"showTop("+msgId+")\">置顶</a>";
								innerHTML += "<a class=\"btn btn-default\" onclick=\"deleteLiveMessage("+msgId+")\">删除</a>";
								innerHTML += "<a class=\"btn btn-default\" onclick=\"1deleteLiveMessage("+msgId+")\">禁言</a>";
								innerHTML += " </div>";
								innerHTML += " </div>";
								innerHTML += " </div>";
								$("#liveDiv").prepend(innerHTML);
								if(autoScroll==0){
									$("#liveDiv").scrollTop(0);
								}else{
									try {
										$("#liveDiv").scrollTop(liveScrollTop+$("#msgDiv_"+msgId).outerHeight());
									} catch (e) {
									}
								}
								}else if(liveMsgType==1){
								if(msgType==1){
								//文字
								var innerHTML = "";
								innerHTML +=" <div class=\"vertical-timeline-block\" id=\"msgDiv_"+msgId+"\">";
								innerHTML +="<div class=\"vertical-timeline-icon gray-bg\">";
								if(null!=senderImage){
								innerHTML +="<img alt=\"image\" class=\"img-circle\" src="+senderImage+">";
								}else{
								innerHTML +="<img alt=\"image\" class=\"img-circle\" src=\"/bvRadioILive/res/bvRadio/img/u768.png\">";
								}
								
								innerHTML +=" </div>";
								innerHTML +="<div class=\"vertical-timeline-content\">";
								innerHTML += "<p><strong class=\"pull-left\">"+senderName+"</strong><span class=\"redtitle\">";
								if(yourself==senderName){
										innerHTML += "官方";
									}else{
										innerHTML += "网友";
									}
								innerHTML += "</span><span class=\"zhiding\">顶</span>";
								innerHTML +="<span class=\"rtime\">"+createTime+"</span></p>";
								innerHTML += "<p class=\"text-muted\">";
								innerHTML +=content
								innerHTML += "</p>";
								innerHTML += " </div>";
								innerHTML += " </div>";
							
								}else if(msgType==2){
						
								//图片
								var innerHTML = "";
								innerHTML +=" <div class=\"vertical-timeline-block\" id=\"msgDiv_"+msgId+"\">";
								innerHTML +="<div class=\"vertical-timeline-icon gray-bg\">";
								if(null!=senderImage){
								innerHTML +="<img alt=\"image\" class=\"img-circle\" src="+senderImage+">";
								}else{
								innerHTML +="<img alt=\"image\" class=\"img-circle\" src=\"/bvRadioILive/res/bvRadio/img/u768.png\">";
								}
								innerHTML +=" </div>";
								innerHTML +="<div class=\"vertical-timeline-content\">";
								innerHTML += "<p><strong class=\"pull-left\">"+senderName+"</strong><span class=\"redtitle\">";
								if(yourself==senderName){
										innerHTML += "官方";
									}else{
										innerHTML += "网友";
									}
								innerHTML += "</span><span class=\"zhiding\">顶</span><span class=\"rtime\">"+createTime+"</span></p>";
								innerHTML += "<p class=\"text-muted\">";
								//多图
								innerHTML += "<div class=\"demo-gallery pull-left\">";
									innerHTML += "<ul class=\"list-unstyled row no-margin lightgallery\">";
									for(var j=0; j<images.length; j++){
										var image = images[j];
										innerHTML += "<li class=\"col-xs-6 col-sm-4 col-md-3\" data-responsive=\""+image+"\" data-src=\""+image+"\">";
										innerHTML += "<a href=\"javascript:void(0)\">";
										innerHTML += "<img class=\"img-responsive\" src=\""+image+"\">";
										innerHTML += "<div class=\"demo-gallery-poster\">";
										innerHTML += "</div>";
										innerHTML += "</a>";
										innerHTML += "</li>";
									}
									innerHTML += "</ul>";
									innerHTML += "</div>";
									//单图
								/* innerHTML +="<img width=\"60\" height=\"60\" src="+content+">" */
								
								innerHTML += "</p>";
								innerHTML += " </div>";
								innerHTML += " </div>";
								}else if(msgType==3){
									//音频
									var innerHTML = "";
								innerHTML +=" <div class=\"vertical-timeline-block\" id=\"msgDiv_"+msgId+"\">";
								innerHTML +="<div class=\"vertical-timeline-icon gray-bg\">";
								if(null!=senderImage){
								innerHTML +="<img alt=\"image\" class=\"img-circle\" src="+senderImage+">";
								}else{
								innerHTML +="<img alt=\"image\" class=\"img-circle\" src=\"/bvRadioILive/res/bvRadio/img/u768.png\">";
								}
								innerHTML +=" </div>";
								innerHTML +="<div class=\"vertical-timeline-content\">";
								innerHTML += "<p><strong class=\"pull-left\">"+senderName+"</strong><span class=\"redtitle\">";
								if(yourself==senderName){
										innerHTML += "官方";
									}else{
										innerHTML += "网友";
									}
								innerHTML += "</span><span class=\"zhiding\">顶</span><span class=\"rtime\">"+createTime+"</span></p>";
								innerHTML += "<p class=\"text-muted\">";
								innerHTML +="<audio width=\"60\" height=\"60\" src='"+content+"' controls/></audio>";
								innerHTML += "</p>";
								innerHTML += " </div>";
								innerHTML += " </div>";
								}else if(msgType==4){
								//视频
								var innerHTML = "";
								innerHTML +=" <div class=\"vertical-timeline-block\" id=\"msgDiv_"+msgId+"\">";
								innerHTML +="<div class=\"vertical-timeline-icon gray-bg\">";
								if(null!=senderImage){
								innerHTML +="<img alt=\"image\" class=\"img-circle\" src="+senderImage+">";
								}else{
								innerHTML +="<img alt=\"image\" class=\"img-circle\" src=\"/bvRadioILive/res/bvRadio/img/u768.png\">";
								}
								innerHTML +=" </div>";
								innerHTML +="<div class=\"vertical-timeline-content\">";
								innerHTML += "<p><strong class=\"pull-left\">"+senderName+"</strong><span class=\"redtitle\">";
								if(yourself==senderName){
										innerHTML += "官方";
									}else{
										innerHTML += "网友";
									}
								innerHTML += "</span><span class=\"zhiding\">顶</span><span class=\"rtime\">"+createTime+"</span></p>";
								innerHTML += "<p class=\"text-muted\">";
								innerHTML +="<video width=\"60\" height=\"60\" src="+content+"  controls/>"
								innerHTML += "</p>";
								innerHTML += " </div>";
								innerHTML += " </div>";
								}
								$("#livDiv").prepend(innerHTML);
								if(autoScroll==0){
										$("#livDiv").scrollTop(0);
									}else{
										try {
											$("#livDiv").scrollTop(liveScrollTop+$("#msgDiv_"+msgId).outerHeight());
										} catch (e) {
										}
									}
								}
					
								
								
								
							
						} catch (e) {
							alert(e);
						}
					
					}
						
					}else{
						alert(data.message);
						try {
						// 直播消息
						var innerHTML = "";
						innerHTML += "<div class=\"alert alert-warning\">";
						innerHTML += "<h4>";
						innerHTML += "<i class=\"icon-exclamation-sign\"></i>";
						innerHTML += "警告：您的账号已经在另外一个IP登陆，您将获取不到消息，请重新进入直播间。";
						innerHTML += "</h4>";
						innerHTML += "</div>";
						$("#livDiv").prepend(innerHTML);
						// 互动消息
						innerHTML = "";
						innerHTML += "<div class=\"alert alert-warning\">";
						innerHTML += "<h4>";
						innerHTML += "<i class=\"icon-exclamation-sign\"></i>";
						innerHTML += "警告：您的账号已经在另外一个地方登陆，您将获取不到消息，请重新进入直播间。";
						innerHTML += "</h4>";
						innerHTML += "</div>";
						$("#liveDiv").prepend(innerHTML);
					} catch (e) {
						alert(e);
					}
					
					}
				},
				error : function(XMLHttpRequest, textStatus, errorThrown) {
					/* alert("deleteLiveMessage出错。"); */
				},
				dataType : "json"
			});
			
	} 
	function deleteLiveMessage(msgId){
		if (confirm("确定要删除吗？")) {
			$.ajax({
				type : 'POST',
				url : "o_delete.do",
				data : {
					liveId : ${liveId!0},
					msgId : msgId
				},
				success : function(data, textStatus) {
					if (data.status == 1) {
						$("#msgDiv_"+msgId).remove();
					}
				},
				error : function(XMLHttpRequest, textStatus, errorThrown) {
					alert("deleteLiveMessage出错。");
				},
				dataType : "json"
			});
		}		
	}
	
	function checkInteractMessage(msgId){
		$.ajax({
			type : 'POST',
			url : "o_check.do",
			data : {
				liveId : ${liveId!0},
				msgId : msgId
			},
			success : function(data, textStatus) {
				if (data.status == 1) {
					
					$("#msgDiv_"+msgId).remove();
					
				 	
				}
			},
			error : function(XMLHttpRequest, textStatus, errorThrown) {
				alert("checkInteractMessage出错。");
			},
			dataType : "json"
		});
	}
	
	function deleteInteractMessage(msgId){
		$.ajax({
			type : 'POST',
			url : "o_delete.do",
			dataType : "json",
			data : {
				liveId : ${liveId!0},
				msgId : msgId
			},
			success : function(data, textStatus) {
				if (data.status == 1) {
					$("#msgDiv_"+msgId).remove();
				}
			},
			error : function(XMLHttpRequest, textStatus, errorThrown) {
				alert("deleteInteractMessage出错。");
			},
		
		});
	}
	
	

</script>
<script>
$(function(){
	$(document).keydown(function(event){
		if($("#textContent").is(":focus")){
			if((event.ctrlKey && event.keyCode == 13)) {
				sendMessage();
			} 
		}
	});
});
</script>
</head>
<body>
	<div id="wrapper">

		<!--右侧内容的区域-->
		<div id="page-wrapper" class="gray-bg">
			<!--上面的导航栏部分-->
			<div class="row border-bottom m-b">
				<nav class="navbar navbar-static-top navbar-top-height"
					role="navigation" style="margin-bottom: 0"><#include
					"/bvRadio/tlap/top.html"/></nav>
			</div>

			<!--左侧部分-->
			<nav class="navbar-default navbar-static-side navbar-width"
				role="navigation">
				<div class="sidebar-collapse">
				           <ul class="nav metismenu nav-left" id="side-menu">
                
                <li>
                     <a class="dropdown-collapse <#if leftActive??&&(leftActive?length>2)&&leftActive?substring(0,2)='7_'>in</#if>" href="##">
                     <i class="fa icon-cogs"></i> 
                        <span class="nav-label">直播管理</span> 
                        <span class="fa arrow"></span>
                     </a>
                    <ul class="nav collapse nav-second-level2 <#if leftActive??&&(leftActive?length>2)&&leftActive?substring(0,2)='7_'>in</#if>">
						<li class="<#if leftActive??&&leftActive='7_1'>active</#if>">
							<a href="${base}/tlap/live/v_active_list.do">
								<i class="icon-caret-right"></i>
								<span>活动直播</span>
							</a>
						</li>
						<li class="<#if leftActive??&&leftActive='7_5'>active</#if>">
							<a href="${base}/tlap/live/v_user_list.do">
								<i class="icon-caret-right"></i>
								<span>主播直播</span>
							</a>
						</li>
					
                    </ul>
                </li>
                <li>
                <!-- <a class="" href="${base}/tlap/interact/v_list.do"> <i
						class="icon-comments-alt"></i> <span>互动管理</span>
				</a> -->
				   <a class="dropdown-collapse <#if leftActive??&&(leftActive?length>2)&&leftActive?substring(0,2)='2_'>in</#if>" href="##">
                     <i class="fa icon-cogs"></i> 
                        <span class="nav-label">互动管理</span> 
                        <span class="fa arrow"></span>
                     </a>
                       <ul class="nav collapse nav-second-level2 <#if leftActive??&&(leftActive?length>2)&&leftActive?substring(0,2)='2_'>in</#if>">
						<li class="<#if leftActive??&&leftActive='2_1'>active</#if>">
							<a href="${base}/tlap/interact/v_list.do">
								<i class="icon-caret-right"></i>
								<span>互动记录</span>
							</a>
						</li>
                    </ul>
				</li>
				<!--  -->
                
				<!--  -->
				
                <li>
                <a class="dropdown-collapse <#if leftActive??&&(leftActive?length>2)&&leftActive?substring(0,2)='5_'>in</#if>"  href="#">
                <i class="fa icon-briefcase"></i> 
                <span class="nav-label">财务管理</span>
                <span class="fa arrow"></span>
                </a>
                <ul class="nav nav-second-level2 collapse  <#if leftActive??&&(leftActive?length>2)&&leftActive?substring(0,2)='5_'>in</#if>">
					
				
					
					<li class="<#if leftActive??&&leftActive='5_1'>active</#if>">
						<a href="${base}/tlap/finan/getRecharge.do">
							<i class="icon-caret-right"></i>
							<span>充值记录</span>
						</a>
					</li>
					<li class="<#if leftActive??&&leftActive='5_2'>active</#if>">
							<a href="${base}/tlap/finan/getPresent.do"> <i
								class="icon-caret-right"></i> <span>提现记录</span>
						</a>
						</li>
						<li class="<#if leftActive??&&leftActive='5_3'>active</#if>">
							<a href="${base}/tlap/finan/getConsumption.do"> <i
								class="icon-caret-right"></i> <span>消费记录</span>
						</a>
						</li>
						<li class="<#if leftActive??&&leftActive='5_9'>active</#if>">
							<a href="${base}/tlap/finan/getRedPage.do"> <i
								class="icon-caret-right"></i> <span>红包记录</span>
							</a>
						</li>
						<li class="<#if leftActive??&&leftActive='5_4'>active</#if>">
							<a href="${base}/tlap/finan/getUserPage.do"> <i
								class="icon-caret-right"></i> <span>账户财务</span>
							</a>
						</li>
						
						<li class="<#if leftActive??&&leftActive='5_6'>active</#if>">
							<a href="${base}/tlap/recharge/getCreateType.do"> <i
								class="icon-caret-right"></i> <span>充值</span>
							</a>
						</li>
				</ul>
                   
                </li>
           
             
            </ul>
			
					
					</div>
			</nav>
			<!--下面内容部分-->
			<div class="wrapper wrapper-content">
				<div class="row border-bottom-ccc">
					<div class="col-lg-12 zbjtitle">
						<div class="pull-left">
							<a href="${base}/tlap/live/v_active_list.do"><i
								class="fa fa-angle-left"></i>返回</a>
						</div>
						<div class="col-lg-4 text-overflow">${title!}</div>
					</div>
				</div>
				<div class="row zbjbody">
					<div class="col-lg-4 white-bg">
						<div class="videobox">
							<!--<video src=""></video>-->
						</div>
						<div class="mainbox">
							<ul id="myTab" class="nav nav-tabs">
								<li class="active"><a href="#tab1" data-toggle="tab">
										采集设备推流 </a>
								</li>
								<li><a href="#tab2" data-toggle="tab">手机直播</a></li>
								<li><a href="#tab3" data-toggle="tab">HLS推流</a></li>
							</ul>
							<div id="myTabContent" class="tab-content">
								<div class="tab-pane fade in active" id="tab1">
									<div class="jianjie">按照以上信息配置编码器，配置正确的推流地址及流名称。
										推荐编码参数设置：使用H.264编码，ACC音频。 按照以上信息配置编码器，配置正确的推流地址及流名称。
										推荐编码参数设置：使用H.264编码，ACC音频。</div>
									<div class="input-group">
										<span class="firstname">推流地址：</span> <input type="text"
											placeholder="http://live.iptv-soft.com/live/" name="push"
											id="push" type='text' value="${hls!}" />
										<button class="btn btn-default copybtn">复制</button>
									</div>
									<div class="input-group">
										<span class="firstname">流名称：</span> <input type="text"
											placeholder="live58645846" name="pushName" id="pushName"
											type='text' value="${title!}" />
										<button class="btn btn-default copybtn">复制</button>
									</div>
								</div>
								<div class="tab-pane fade" id="tab2">
									<div class="jianjie">按照以上信息配置编码器，配置正确的推流地址及流名称。
										推荐编码参数设置：使用H.264编码，ACC音频。 按照以上信息配置编码器，配置正确的推流地址及流名称。
										推荐编码参数设置：使用H.264编码，ACC音频。</div>
									<div class="input-group">
										<span class="firstname">手机地址：</span> <input type="text"
											placeholder="http://live.iptv-soft.com/live/" name="phone"
											id="push" type='text' value="${hls!}" />
										<button class="btn btn-default copybtn">复制</button>
									</div>
									<div class="input-group">
											placeholder="live58645846" name="phoneName" id="pushName"
											type='text' value="${title!}" />
										<button class="btn btn-default copybtn">复制</button>
									</div>
								</div>
								<div class="tab-pane fade" id="tab3">
									<div class="jianjie">按照以上信息配置编码器，配置正确的推流地址及流名称。
										推荐编码参数设置：使用H.264编码，ACC音频。 按照以上信息配置编码器，配置正确的推流地址及流名称。
										推荐编码参数设置：使用H.264编码，ACC音频。</div>
									<div class="input-group">
										<span class="firstname">拉流地址：</span> <input type="text"
											placeholder="http://live.iptv-soft.com/live/"
											name="channelName" id="channelName" type='text'
											value="${live.channelName!}" />
										<button class="btn btn-default copybtn">复制</button>
									</div>
									<div class="input-group">
										<span class="firstname">流名称：</span> <input type="text"
											placeholder="live58645846" name="liveOneWord"
											id="liveOneWord" type='text' value="${live.liveOneWord!}" />
										<button class="btn btn-default copybtn">复制</button>
									</div>
								</div>

							</div>
						</div>
					</div>
					<div class="col-lg-8">
						<div class="row white-bg">
							<ul id="rightTab" class="nav nav-tabs">
								<li class="active"><a href="#lthd" data-toggle="tab">聊天互动</a>
								</li>
								<li><a href="#twzb" data-toggle="tab">图文直播</a></li>
								<!--<li><a href="#zdycd" data-toggle="tab">自定义菜单</a></li>-->
							</ul>
						</div>
						<div id="rightTabContent" class="tab-content">
							<div class="tab-pane fade in active" id="lthd">
								<div class="row gray-bg h-40">
									<div class="col-lg-12">
										<div class="switchbox pull-left">
											<label class="pull-left">自动审核</label>
											<div class="open1 btn-switch" id="autoCheck">
												<div class="open2 btn-switch2">
													<label for="autoCheck"></label>
												</div>
											</div>
										</div>
										<div class="switchbox pull-left">
											<label class="pull-left">自动滚屏</label>
											<div class="open1 btn-switch" id="autoScroll">
												<div class="open2 btn-switch2">
													<label for="autoCheck"></label>
												</div>
											</div>
										</div>
										<div class="switchbox pull-right m-r">
											<a class="btn btn-default" onclick="clearliveMessage()">清空 <i class="fa fa-trash"></i>
											</a>
										</div>
									
									</div>
								</div>
								<div class="row commentbox white-bg">
									<div class="widget-content " id="liveDiv">
										 <div id="topDiv">
										<#if interactMsgList??> <#list
										interactMsgList?reverse as liveMsg>
									
										<div class="feed-element p-19 border-bottom-ccc <#if liveMsg.checked!>checked<#else>unchecked</#if>" id="msgDiv_${liveMsg.msgId!}">
											<a class="pull-left"> <img alt="image" class="img-circle"
												src="${liveMsg.senderImage!'${base}/res/bvRadio/img/u768.png'}"> </a>
											<div class="media-body ">
												<p>
													<strong class="pull-left">${liveMsg.senderName!'未知用户'}</strong><span
														class="redtitle"> <#if
														liveMsg.senderName==topUser.username>官方<#else>网友</#if></span><span
														class="zhiding">顶</span>
												</p>
												<p class="text-muted">${liveMsg.content!}</p>
												<div class="col-lg-9 pull-right text-right">
													<#if liveMsg.msgType??&&liveMsg.msgType==1> <#if
												!liveMsg.checked>
													<a class="btn btn-default"
														onclick="checkInteractMessage(${liveMsg.msgId!})">通过</a> 
														</#if>
														<a
														class="btn btn-default"
														onclick="showTop(${liveMsg.msgId!})">置顶</a> <a
														class="btn btn-default"
														onclick="deleteLiveMessage(${liveMsg.msgId!})">删除</a> <a
														class="btn btn-default"
														onclick="deleteLiveStopMessage(${liveMsg.msgId!})">禁言</a>
														</#if>
												</div>
											</div>
										</div>
									

										</#list> </#if>										  
										<#if interactCheckedMsgList??> <#list
										interactCheckedMsgList?reverse as liveMsg>
									
										<div class="feed-element p-19 border-bottom-ccc <#if liveMsg.checked!>checked<#else>unchecked</#if>" id="msgDiv_${liveMsg.msgId!}">
											<a class="pull-left"> <img alt="image" class="img-circle"
												src="${liveMsg.senderImage!'${base}/res/bvRadio/img/u768.png'}"> </a>
											<div class="media-body ">
												<p>
													<strong class="pull-left">${liveMsg.senderName!'未知用户'}</strong><span
														class="redtitle"> <#if
														liveMsg.senderName==topUser.username>官方<#else>网友</#if></span><span
														class="zhiding">顶</span>
												</p>
												<#if liveMsg.msgType??&&liveMsg.msgType==1>
												<p class="text-muted">${liveMsg.content!}</p>
												<#else>
												<p class="text-muted">邀请您参加活动，活动的地址是:http://47.100.62.168:8484/bvRadioBBS/activity/v_fill.jspx?activityId=${liveMsg.content!}</p>
												</#if>
												<div class="col-lg-9 pull-right text-right">
													<#if liveMsg.msgType??&&liveMsg.msgType==1> <#if
												!liveMsg.checked>
													<a class="btn btn-default"
														onclick="checkInteractMessage(${liveMsg.msgId!})">通过</a> 
														</#if>
														</#if>
														<a
														class="btn btn-default"
														onclick="showTop(${liveMsg.msgId!})">置顶</a> <a
														class="btn btn-default"
														onclick="deleteLiveMessage(${liveMsg.msgId!})">删除</a> <a
														class="btn btn-default"
														onclick="deleteLiveStopMessage(${liveMsg.msgId!})">禁言</a>
														<!--  -->
												</div>
											</div>
										</div>
										</#list> </#if>
										</div>
									</div>

								</div>
								<div class="col-lg-12 gray-bg m-t m-b">
									<textarea class="col-lg-12" placeholder="说点什么吧" id=textContent></textarea>
									<div class="faceDiv" id="faceDiv"></div>
								</div>
								<div class="col-lg-12">
									<div class="col-lg-10">
					
										<div class="circleimg" id="expression">
											<img src="${base}/res/bvRadio/img/biaoqing.png" />
										</div>
										<div id="show"></div> 
									
										<button class="circleimg" type="button"
												style="margin-bottom: 1px; margin-left: 1px;"
												data-toggle='modal'  onclick="showActive(5);"
												title="报名活动">
													<img src="${base}/res/bvRadio/img/u856.png" />
										</button>
										<button class="circleimg" type="button"
												style="margin-bottom: 1px; margin-left: 1px;"
												data-toggle='modal' onclick="showActive(1);"
												title="投票活动">
													<img src="${base}/res/bvRadio/img/toupiao.png" />
										</button>
										<!-- <button class="circleimg" type="button"
												style="margin-bottom: 1px; margin-left: 1px;"
												data-toggle='modal' href='#modal-wrap' onclick="showActive(2);"
												title="抽奖活动">
													<img src="${base}/res/bvRadio/img/choujiang.png" />
										</button>
										<button class="circleimg" type="button"
												style="margin-bottom: 1px; margin-left: 1px;"
												data-toggle='modal' href='#modal-wrap' onclick="showActive(3);"
												title="发送红包">
													<img src="${base}/res/bvRadio/img/hongbao.png" />
										</button>
										<button class="circleimg" type="button"
												style="margin-bottom: 1px; margin-left: 1px;"
												data-toggle='modal' href='#modal-wrap' onclick="showActive(4);"
												title="发送礼品">
													<img src="${base}/res/bvRadio/img/gift.png" />
										</button>  -->
									</div>
									<div class="col-lg-2 text-right">
										<input type="hidden" name="msgType" id="msgType" value="1">
										<input type="hidden" name="sessionId" id="sessionId"
											value="${(sessionId)!}"> 
										<input type="hidden" name="userId" id="userId"
											value="${(user.userId)!}"> 
										<input type="hidden" name="senderName" id="senderName"
											value="${(live.creatorName)!}"> <input type="hidden"
											name=liveMsgType id="liveMsgType" value="2"> <a
											class="btn btn-default pull-right" onclick="sendMessage()">发表</a>
									</div>
								</div>
							</div>
							<div class="tab-pane fade" id="twzb">
								<div class="row gray-bg h-40">
									<div class="col-lg-12">
										
										<div class="switchbox pull-right m-r">
											<a class="btn btn-default" onclick="clearMessage()">清空 <i class="fa fa-trash"></i>
											</a>
										</div>
									
									</div>
								</div>
								<div class="row commentbox white-bg">
			
										<div id="vertical-timeline"
											class="vertical-container dark-timeline">
											<div id="livDiv">
												<div id="topDiv">
												<#if liveMsgList??>
												<#list liveMsgList?reverse as liveMsg>
												<#if liveMsg.liveMsgType==1>
											
												
												<div class="vertical-timeline-block" id="msgDiv_${liveMsg.msgId!}">
													<div class="vertical-timeline-icon gray-bg">
														<img alt="image" class="img-circle"
															src="${liveMsg.senderImage!'${base}/res/bvRadio/img/u768.png'}">
													</div>
													<div class="vertical-timeline-content">
														<p>
															<strong class="pull-left">${liveMsg.senderName!'未知用户'}</strong><span
																class="redtitle"> <#if
																liveMsg.senderName==topUser.username>官方<#else>网友</#if></span><span
																class="zhiding">顶</span> <span class="rtime">${(liveMsg.createTime?string("MM-dd
																HH:mm:ss"))!}</span>
														</p>
									
														<#if liveMsg.msgType??&&liveMsg.msgType==1>
														<p class="text-muted">${liveMsg.content!}</p>
														<#elseif liveMsg.msgType??&&liveMsg.msgType==2>
														
														<#if liveMsg.images??>
														
															<p class="text-muted">${liveMsg.content?substring(0,(liveMsg.content?index_of("|")))}</p>
															<div class="demo-gallery pull-left">
																<ul class="list-unstyled row no-margin lightgallery">
																	<#list liveMsg.images as image>
																		<li class="col-xs-6 col-sm-4 col-md-3" data-responsive="${image!}" data-src="${image!}">
																			<a href="default.htm">
																			<img class="img-responsive" src="${image!}">
																			<div class="demo-gallery-poster">
																			</div>
																			</a>
															</li>
																	</#list>
																</ul>
															</div>
														</#if>
														<!-- <p class="text-muted"><img width="60px" height="60px" src="${liveMsg.content!}"/></p>  -->
														<#elseif liveMsg.msgType??&&liveMsg.msgType==3>
														<p class="text-muted">${liveMsg.content?substring(0,(liveMsg.content?index_of("|")))}</p>
														<p class="text-muted"><audio   src="${liveMsg.content?substring((liveMsg.content?index_of("|")+1))}" controls></audio></p> 
														<#elseif liveMsg.msgType??&&liveMsg.msgType=4>
														<p class="text-muted">${liveMsg.content?substring(0,(liveMsg.content?index_of("|")))}</p>
														<p class="text-muted"><div width="60px" height="60px"><video src="${liveMsg.content?substring((liveMsg.content?index_of("|")+1))}" controls></video></div></p> 
														</#if> 
														
													</div>
												</div>
												</#if>
												</#list> </#if>
												</div>
											</div>
										</div>
									
								</div>
								<div class="editFaceDiv" id="editFaceDiv"></div>
								<div id=Content></div>
								<div class="col-lg-12 gray-bg m-t m-b" id=Content>
									<textarea class="col-lg-12" placeholder="说点什么吧"   id=textContent1></textarea>
								</div>
								<div class="Imginput_Box" id="Imginput_Box">
										<dl class='unstyled pull-left list-striped'>
										</dl>
								</div>
								<div class="Audio_Box" id="Audio_Box">
										<dl class='unstyled pull-left list-striped'>
										</dl>
								</div>
								<div class="Video_Box" id="Video_Box">
										<dl class='unstyled pull-left list-striped'>
										</dl>
								</div>
								<div class="col-lg-12">
									<div class="col-lg-10">
										<div class="circleimg"  id="editExpression">
											<img src="${base}/res/bvRadio/img/biaoqing.png" alt="" />
										</div>
								
										<div data-original-title="图片" data-placement="bottom"
											class="has-tooltip pull-left mb5 mr5" id="imageDiv" style="width:31px;height:31px">
											<input type="hidden" id="imgUpload" >
											<div id="uploadProgressWrap" style="display: none"></div>
										</div>
									<!-- 	 <div data-original-title="音频" data-placement="bottom"
											class="has-tooltip pull-left mb5 mr5" id="audioDiv" style="width:31px">
											<input type="hidden" id="audioUpload">
											<div id="uploadAudioProgressWrap" style="display: none"></div>
										</div>
										<div data-original-title="视频" data-placement="bottom"
											class="has-tooltip pull-left mb5 mr5" id="videoDiv" style="width:31px">
											<input type="hidden" id="videoUpload">
											<div id="uploadVideoProgressWrap" style="display: none"></div>
										</div> -->
										<button class="circleimg" type="button"
												style="margin-bottom: 1px; margin-left: 1px;"
												data-toggle='modal' href='#modal-wrap' onclick="showMedia(6);"
												title="内容库音频">
													<img src="${base}/res/bvRadio/img/yuyin.png" />
										</button>
										<button class="circleimg" type="button"
												style="margin-bottom: 1px; margin-left: 1px;"
												data-toggle='modal' href='#modal-wrap' onclick="showMedia(5);"
												title="内容库视频">
													<img src="${base}/res/bvRadio/img/shipin.png" />
										</button>
										
									</div>
									<div class="col-lg-2 text-right">
										<input type="hidden" name="msgType" id="msgType" value="1">
										<input type="hidden" name="senderName" id="senderName"
											value="{live.creatorName}"> <input type="hidden"
											name=liveMsgType id="liveMsgType1" value="1"> <a
											class="btn btn-default pull-right" onclick="sendMessage1()">发表</a>
											
									</div>
								</div>
							</div>

						</div>
					</div>
				</div>

			</div>
			<#include "/bvRadio/bottom.html"/>
</body>

<script type="text/javascript">
 $(document).ready(function(){
  $(".list").mouseenter(function(){
  $(this).children(".text").show();
   $(this).children(".del").show();
    $(this).children(".listcen").children("img").show();
  $(this).children(".listright").children("a").children(".lisa").children(".list-time").hide();
 
  });
  $(".list").mouseleave(function(){
  $(this).children(".text").hide();
  $(this).children(".del").hide();
   $(this).children(".listcen").children("img").hide();
  $(this).children(".listright").children("a").children(".lisa").children(".list-time").show();
	
  });


	if($.cookie("autoCheckCookie_${liveId!0}")=='0'){
			$("#autoCheck").val(0);
		}else{
			$("#autoCheck").val(1);
		}
		if($.cookie("autoScrollCookie_${liveId!0}")=='0'){
			$("#autoScroll").val(0);
		}else{
			$("#autoScroll").val(1);
		}
	var int=self.setInterval("getMsg()",1000);
	var int=self.setInterval("autoCheck()",10000);
	$("#autoCheck").click(function (){
			if($("#autoCheck").val==0){
				$.cookie("autoCheckCookie_${liveId!0}", "0", { expires: 9999 }); 
			}else{
				$.cookie("autoCheckCookie_${liveId!0}", "1", { expires: 9999 }); 
			}
		});
	
}); 

//开关按钮
$(".btn-switch").click(function(){
    if($(this).hasClass("open1")){
        $(this).addClass("close1").removeClass("open1");
        $("#autoCheck").val(1);
    }else{
        $(this).addClass("open1").removeClass("close1");
        $("#autoCheck").val(0);
    }
    if($(this).find(".btn-switch2").hasClass("open2")){
        $(this).find(".btn-switch2").addClass("close2").removeClass("open2");
        $("#autoScroll").val(1);
    }else{
        $(this).find(".btn-switch2").addClass("open2").removeClass("close2");
        $("#autoScroll").val(0);
    }
})
</script>


<script>

$(".listleft span input").mouseenter(function(){
	 $(this).css("border","1px solid #39f");
})
$(".listleft span input").mouseleave(function(){
	 $(this).css("border","none");
})
$('.commentbox').slimScroll({
    color: 'rgba(0,0,0,0)',
    size: '10px',
    height: "440px",
    alwaysVisible: false
});


</script>
<script>
function showTop(msgId){
	
/* 	$("#msgDiv_"+msgId).find(".senderName").parent().append("<span class=\"m-l-xs\"><img src=\"${base}/res/bvRadio/img/u778.png\"></span>"); */
	var html=$("#msgDiv_"+msgId).html();
	alert("msgDiv_"+msgId);
	$("#msgDiv_"+msgId).remove();
	$("#topDiv").prepend("<div class=\"feed-element p-19 border-bottom-ccc\" id=\"msgDiv_"+msgId+"\">"+html+"</div>");
	if (msgId) {
		$.ajax({
			type : 'POST',
			url : "o_update_live_message_level.do",
			data : {
				liveId : ${liveId!0},
				msgId : msgId
			},
			success : function(data, textStatus) {
				if (data.status == 1) {
					alert("置顶成功");
				}
			},
			error : function(XMLHttpRequest, textStatus, errorThrown) {
				alert("消息不存在");
			},
			dataType : "json"
		});
		
	}
}

function clearliveMessage(){
		$("#liveDiv").remove();

}
function clearMessage(){
		$("#livDiv").remove();

}

function deleteLiveStopMessage(msgId){
		alert(msgId);
		if (confirm("确定要禁言吗？")) {
			$.ajax({
				type : 'POST',
				url : "o_1delete.do",
				data : {
					liveId : ${liveId!0},
					msgId : msgId,
					senderName : senderName
				},
				success : function(data, textStatus) {
					if (data.status == 1) {
						$("#msgDiv_"+msgId).remove();
					}
				},
				error : function(XMLHttpRequest, textStatus, errorThrown) {
					alert("1deleteLiveMessage出错。");
				},
				dataType : "json"
			});
		}		
	}
		
	function showActive(obj){
	
/* 	 var html ="";
	html+="<button class='close' data-dismiss='modal' type='button'>&times;</button>"; */
	if(obj==1){
	var userId=$("#userId").val();
	window.open("http://47.100.62.168:8484/bvRadioBBS/bbs/admin/voteImg/live_list.do?communityId=441&liveId=${liveId!0}&userId="+userId);
	/* html+='<h3>投票活动</h3>';
	$(".modal-header").html(html);
		var userId=$("#userId").val();
	 	$("#modelFrame").attr("src","http://47.100.62.168:8484/bvRadioBBS/bbs/admin/voteImg/live_list.do?communityId=441&liveId=${liveId!0}&userId="+userId); 
		
	 */
	}
	if(obj==2){
	html+='<h3>抽奖活动</h3>';
	}
	if(obj==3){
	html+='<h3>发送红包</h3>';
	}
	if(obj==4){
	html+='<h3>发送礼品</h3>';
	}
	if(obj==5){
	var userId=$("#userId").val();
	window.open("http://47.100.62.168:8484/bvRadioBBS/bbs/admin/apply/live_list.do?communityId=441&liveId=${liveId!0}&userId="+userId);
	/* html+='<h3>报名活动</h3>'; */
/* 	$(".modal-header").html(html);
		var userId=$("#userId").val();
	 	$("#modelFrame").attr("src","http://47.100.62.168:8484/bvRadioBBS/bbs/admin/apply/live_list.do?communityId=441&liveId=${liveId!0}&userId="+userId); 
		 */
	}
	}
	
	function showMedia(obj){
	var html ="";
	html+="<button class='close' data-dismiss='modal' type='button'>&times;</button>";
	if(obj==1){
	html+='<h3>音频资源</h3>';
	}
	if(obj==2){
	html+='<h3>视频资源</h3>';
	}
	$(".modal-header").html(html);
		/* $("#modal-wrap").show(); */
		$("#modelFrame").attr("src","../s_media.do?type="+obj);
	}
	
	
function enrollActive(){
	
	window.open("http://127.0.0.1:8080/bvRadioILive/admin/live/s_enroll.do");   
	
}



function deleteLiveMessage(msgId){
		if (confirm("确定要删除吗？")) {
			$.ajax({
				type : 'POST',
				url : "o_delete.do",
				data : {
					liveId : ${liveId!0},
					msgId : msgId
				},
				success : function(data, textStatus) {
					if (data.status == 1) {
						$("#msgDiv_"+msgId).remove();
					}
				},
				error : function(XMLHttpRequest, textStatus, errorThrown) {
					alert("deleteLiveMessage出错。");
				},
				dataType : "json"
			});
		}		
	}
		function sendMessage(){
		var msgType = $("#msgType").val();
		var msgContent = "";
		if(msgType==1){
			msgContent = $("#textContent").val();
		}else if(msgType==2){
			var valArr = new Array;
		    $("#Imginput_Box .imgContent").each(function(i){
		    	valArr[i] = $(this).val();
			});
	     	msgContent = valArr.join(',');
		}
	    var senderName = $("#senderName").val();
	    //alert(senderName+":>"+msgContent+"<");
		if(senderName.replace(" ","").length==0){
			alert("发言人不能为空");
			return;
		}
		if(msgContent.replace(" ","").length==0){
			alert("发送内容不能为空");
			return;
		}
		var liveMsgType = $("#liveMsgType").val();
		var ajaxUrl = "";
		if(liveMsgType==1){
			ajaxUrl = "o_send_live_message.do";
		}else if(liveMsgType==2){
			ajaxUrl = "o_send_interact_message.do";
		}
		var fontColor = $("#fontColor").val();
		$.ajax({
			type : 'POST',
			url : ajaxUrl,
			data : {
				liveId : ${liveId!0},
				senderName : senderName,
				content : msgContent,
				msgType : msgType,
				fontColor : fontColor
			},
			success : function(data, textStatus) {
				$("#msgType").val(1);
				$("#textContent").val("");
			 	$("#Imginput_Box dl").html("");
				$('#textContent').show();
				$('#Imginput_Box').hide();
				$('#width').val("");
				$('#height').val("");
				$('#width').removeAttr("value");
				$('#height').removeAttr("value");
				$("#textContent").css("color","#000000");
				$("#fontColor").trigger("colorpickersliders.updateColor", "#000000");
			},
			error : function(XMLHttpRequest, textStatus, errorThrown) {
				alert("sendMessage出错。");
			},
			dataType : "json"
		});
	}
		function sendMessage1(){
		var msgType = $("#msgType").val();
		var msgContent = "";
		if(msgType==1){
			msgContent = $("#textContent1").val();
		}else if(msgType==2){
			var valArr = new Array;
		    $("#Imginput_Box .imgContent").each(function(i){
		    	valArr[i] = $(this).val();
			});
	     	msgContent = valArr.join(',');
		}else if(msgType==3){
			msgContent = $("#textContent1").val();
	     	
		}else if(msgType==4){
			msgContent = $("#textContent1").val();

		}	
	    var senderName = $("#senderName").val();
	    //alert(senderName+":>"+msgContent+"<");
		if(senderName.replace(" ","").length==0){
			alert("发言人不能为空");
			return;
		}
		if(msgContent.replace(" ","").length==0){
			alert("发送内容不能为空");
			return;
		}
		var liveMsgType = $("#liveMsgType1").val();
		var ajaxUrl = "";
		if(liveMsgType==1){
			ajaxUrl = "o_send_live_message.do";
		}else if(liveMsgType==2){
			ajaxUrl = "o_send_interact_message.do";
		}
		var fontColor = $("#fontColor").val();
		$.ajax({
			type : 'POST',
			url : ajaxUrl,
			data : {
				liveId : ${liveId!0},
				senderName : senderName,
				content : msgContent,
				msgType : msgType,
				fontColor : fontColor
			},
			success : function(data, textStatus) {
				$("#msgType").val(1);
				$("#textContent1").val("");
			 	$("#Imginput_Box dl").html("");
			 	$("#Audio_Box dl").html("");
			 	$("#Video_Box dl").html("");
			 	$('#audioDiv').show();
				$('#videoDiv').show();
				$('#imageDiv').show();
			 	$('#Content').show();
				$('#textContent1').show();
				$('#Imginput_Box').hide();
				$('#Video_Box').hide();
				$('#Audio_Box').show();
				$('#Imginput_Box').hide();
			    $('#Content').hide();
				$('#width').val("");
				$('#height').val("");
				$('#width').removeAttr("value");
				$('#height').removeAttr("value");
				$("#textContent").css("color","#000000");
				$("#fontColor").trigger("colorpickersliders.updateColor", "#000000");
			},
			error : function(XMLHttpRequest, textStatus, errorThrown) {
				alert("sendMessage出错。");
			},
			dataType : "json"
		});
	}
			
	</script>
	<script>
	//音频
	$(function() {
			var upload_url = getUploadUrl();
			var jsessionid = $("#sessionId").val();
			if (jsessionid) {
				upload_url += ";jsessionid=" + jsessionid;
			}
			var fileSizeLimit = "2GB";
			$('#audioUpload').uploadify({
				'queueID':'uploadAudioProgressWrap',
			    'swf': '${base}/thirdparty/uploadify/uploadify.swf',	//指定上传控件的主体文件
			    'uploader': upload_url,	//指定服务器端上传处理文件
			    'auto':true,
			    'multi':true,
			    'buttonCursor':'hand',
			    'fileObjName':'Filedata',
			    'fileSizeLimit':20480,
			    'fileTypeExts':"*.MP3;*.WMA;*.WAV",
			    'width' : 20,
				'height' : 20,
				'buttonText':'',
				'removeCompleted':true,
				'removeTimeout':1,
				'itemTemplate':'',
				'onUploadSuccess' : function(file, data, response) {
					alert(2);
					$("#msgType").val(3);
					$('#videoDiv').hide();
					$('#imageDiv').hide();
					$('#textContent1').hide()
					$('#Video_Box').hide();
					$('#Audio_Box').show();
					$('#Imginput_Box').hide();
			    	$('#Content').hide();
					var jsonObj = eval('(' + data + ')');
					var filePath =  jsonObj.filePath;
					var thumbImgFilePath =  jsonObj.thumbImgFilePath;
					var fileRootUrl =  jsonObj.fileRootUrl;
					var uploadServerId = jsonObj.uploadServerId;
					var width = jsonObj.width;
					var height = jsonObj.height;
					var imageHtml = "";
					imageHtml += "<dd class=\"pull-left\" width=\"86\" height=\"86\" align=\"center\">";
					imageHtml += "<a title=\"photo by xixi\" rel=\"lightbox\" href=\"javascript:void(0)\">";
					imageHtml += "<img width=\"60\" height=\"60\" border=\"0\" src=\"/bvRadioILive/res/bvRadio/img/Yinpin.png\"/>";
					imageHtml += "<input class=\"imgContent\" type=\"hidden\" name=\"imgContent\" value=\""+fileRootUrl +filePath+"\">";
					imageHtml += "</a>";
					imageHtml += "<div class=\"del icon-remove-sign deleteImgButton\"></div>";
					imageHtml += "</dd>";
					$("#Audio_Box dl").append(imageHtml);
			    },
			    'onUploadStart':function(d){
			    	console.log(d);
			    	
			    },
			    'onSelect':function(){
			    },
			    'onInit':function(){
					$("#audioUpload-button").attr("class","uploadify-button");
					$("#audioUpload-button").css({"background":"url('${base}/res/bvRadio/img/tupian.png') no-repeat","background-size":"100% 100%","width":"29px","height":"29px"})
			    },
			    'onUploadError':function(e,i,h){
			    	console.log("error");
			    	console.log(e);
			    	console.log(i);
			    	console.log(h);
			    	console.log("error22");
			    }
			});
			$(document).on("click",".deleteImgButton",function(){
				$(this).parent().remove();
				var imagesWarp = $("#Audio_Box dl dd");
				if(imagesWarp.length<=0){
					$("#msgType").val(1);
					$('#Content').show();
					$('#Video_Box').hide();
					$('#Audio_Box').hide();
					$('#Imginput_Box').hide();
					$('#width').val("");
					$('#height').val("");
					$('#width').removeAttr("value");
					$('#height').removeAttr("value");
				}
			});
		});
		
	
	
	
	</script>
	<script >
	//视频
	$(function() {
			var upload_url = getUploadUrl();
			var jsessionid = $("#sessionId").val();
			if (jsessionid) {
				upload_url += ";jsessionid=" + jsessionid;
			}
			var fileSizeLimit = "100MB";
			$('#videoUpload').uploadify({
				'queueID':'uploadVideoProgressWrap',
			    'swf': '${base}/thirdparty/uploadify/uploadify.swf',	//指定上传控件的主体文件
			    'uploader': upload_url,	//指定服务器端上传处理文件
			    'auto':true,
			    'multi':true,
			    'buttonCursor':'hand',
			    'fileObjName':'Filedata',
			    'fileSizeLimit':"100MB",
			    'fileTypeExts':"*.MP4",
			    'width' : 20,
				'height' : 20,
				'buttonText':'',
				'removeCompleted':true,
				'removeTimeout':1,
				'successTimeout':1000,
				'itemTemplate':'',
				'onUploadSuccess' : function(file, data, response) {
				alert(3);
					$("#msgType").val(4);
					$('#audioDiv').hide();
					$('#imageDiv').hide();
					$('#textContent1').hide()
					$('#Video_Box').show();
					$('#Audio_Box').hide();
					$('#Imginput_Box').hide();
			    	$('#Content').hide();
					var jsonObj = eval('(' + data + ')');
					var filePath =  jsonObj.filePath;
					/* var thumbImgFilePath =  jsonObj.thumbImgFilePath; */
					var fileRootUrl =  jsonObj.fileRootUrl;
					/* var uploadServerId = jsonObj.uploadServerId; */
					/* var width = jsonObj.width;
					var height = jsonObj.height; */
					var imageHtml = "";
					imageHtml += "<dd class=\"pull-left\" width=\"86\" height=\"86\" align=\"center\">";
					imageHtml += "<a title=\"photo by xixi\" rel=\"lightbox\" href=\"javascript:void(0)\">";
					imageHtml += "<img width=\"60\" height=\"60\" border=\"0\" src=\"/bvRadioILive/res/bvRadio/img/Yinpin.png\"/>";
					imageHtml += "<input class=\"imgContent\" type=\"hidden\" name=\"imgContent\" value=\""+fileRootUrl +filePath+"\">";
					imageHtml += "</a>";
					imageHtml += "<div class=\"del icon-remove-sign deleteImgButton\"></div>";
					imageHtml += "</dd>";
					$("#Video_Box dl").append(imageHtml);
			    },
			    'onUploadStart':function(d){
			    	console.log(d);
			    },
			    'onSelect':function(){
			    },
			    'onInit':function(){
					$("#videoUpload-button").attr("class","uploadify-button");
					$("#videoUpload-button").css({"background":"url('${base}/res/bvRadio/img/tupian.png') no-repeat","background-size":"100% 100%","width":"29px","height":"29px"})
			    },
			    'onUploadError':function(e,i,h){
			    	console.log("error");
			    	console.log(e);
			    	console.log(i);
			    	console.log(h);
			    	console.log("error22");
			    }
			});
			$(document).on("click",".deleteImgButton",function(){
				$(this).parent().remove();
				var imagesWarp = $("#Video_Box dl dd");
				if(imagesWarp.length<=0){
					$("#msgType").val(1);
					$('#Content').show();
					$('#Video_Box').hide();
					$('#Audio_Box').hide();
					$('#Imginput_Box').hide();
					$('#width').val("");
					$('#height').val("");
					$('#width').removeAttr("value");
					$('#height').removeAttr("value");
				}
			});
		});
		
		
	
	</script>
	
	<script src="${base}/res/common/js/JWZT_Player.js"
		type="text/javascript"></script>

	<script>
		$(function() {
			ImgIputHandler.Init();
			EditImgIputHandler.Init();
		});
		var ImgIputHandler = {
			facePath : [
				<#if expresssionMapList??&&expresssionMapList?size gt 0>
				<#list expresssionMapList as expresssionMap>
				<#assign key=expresssionMap["key"] />
				<#assign value=expresssionMap["value"] />
				<#assign data=value?eval />
				{faceName:"${key}",faceImgPath:"${data.path!}",faceTitle:"${data.title!}"},
				</#list>
				{faceName:"",faceImgPath:"",faceTitle:""},
				</#if>
			],
			Init : function() {
				var isShowImg=false;
				$("#expression").click(function() {
					$("#faceDiv").show();
					if (isShowImg == false) {
						isShowImg = true;
						$(this).parent().prev().animate({
							marginTop : ""
						}, 0);
						if ($("#faceDiv").children().length == 0) {
							for (var i = 0; i < ImgIputHandler.facePath.length; i++) {
								if (ImgIputHandler.facePath[i].faceName != "") {
									$("#faceDiv").append("<img title=\""+ImgIputHandler.facePath[i].faceTitle+"\" src=\"${base}/res/bvRadio/face"+ImgIputHandler.facePath[i].faceImgPath+"\" faceName=\"["+ImgIputHandler.facePath[i].faceName+"]\" />");
								}
							}
							$("#faceDiv>img").click(function() {
								isShowImg = false;
								$(this).parent().animate({
									marginTop : "0px"
								}, 300);
								$("#faceDiv").hide();
								ImgIputHandler.insertAtCursor($("#textContent")[0], "[" + $(this).attr("title") + "]");
							});

						}
					} else {
						isShowImg = false;
						$("#faceDiv").hide();
					}
				});
			},
			insertAtCursor : function(myField, myValue) {
				if (document.selection) {
					myField.focus();
					sel = document.selection.createRange();
					sel.text = myValue;
					sel.select();
				} else if (myField.selectionStart || myField.selectionStart == "0") {
					var startPos = myField.selectionStart;
					var endPos = myField.selectionEnd;
					var restoreTop = myField.scrollTop;
					myField.value = myField.value.substring(0, startPos) + myValue + myField.value.substring(endPos, myField.value.length);
					if (restoreTop > 0) {
						myField.scrollTop = restoreTop;
					}
					myField.focus();
					myField.selectionStart = startPos + myValue.length;
					myField.selectionEnd = startPos + myValue.length;
				} else {
					myField.value += myValue;
					myField.focus();
				}
			}
		}
		var EditImgIputHandler = {
			facePath : [
				<#if expresssionMapList??&&expresssionMapList?size gt 0>
				<#list expresssionMapList as expresssionMap>
				<#assign key=expresssionMap["key"] />
				<#assign value=expresssionMap["value"] />
				<#assign data=value?eval />
				{faceName:"${key}",faceImgPath:"${data.path!}",faceTitle:"${data.title!}"},
				</#list>
				{faceName:"",faceImgPath:"",faceTitle:""},
				</#if>
			],
			Init : function() {
				var isShowImg=false;
				$("#editExpression").click(function() {
				
					$("#editFaceDiv").show();
					if (isShowImg == false) {
						isShowImg = true;
						$(this).parent().prev().animate({
							marginTop : ""
						}, 0);
						if ($("#editFaceDiv").children().length == 0) {
							for (var i = 0; i < ImgIputHandler.facePath.length; i++) {
								if (ImgIputHandler.facePath[i].faceName != "") {
									$("#editFaceDiv").append("<img title=\""+ImgIputHandler.facePath[i].faceTitle+"\" src=\"${base}/res/bvRadio/face"+ImgIputHandler.facePath[i].faceImgPath+"\" faceName=\"["+ImgIputHandler.facePath[i].faceName+"]\" />");
								}
							}
							$("#editFaceDiv>img").click(function() {
								isShowImg = false;
								$(this).parent().animate({
									marginTop : "0px"
								}, 300);
								$("#editFaceDiv").hide();
								ImgIputHandler.insertAtCursor($("#textContent1")[0], "[" + $(this).attr("title") + "]");
							});

						}
					} else {
						isShowImg = false;
						$("#editFaceDiv").hide();
					}
				});
			},
			insertAtCursor : function(myField, myValue) {
				if (document.selection) {
					myField.focus();
					sel = document.selection.createRange();
					sel.text = myValue;
					sel.select();
				} else if (myField.selectionStart || myField.selectionStart == "0") {
					var startPos = myField.selectionStart;
					var endPos = myField.selectionEnd;
					var restoreTop = myField.scrollTop;
					myField.value = myField.value.substring(0, startPos) + myValue + myField.value.substring(endPos, myField.value.length);
					if (restoreTop > 0) {
						myField.scrollTop = restoreTop;
					}
					myField.focus();
					myField.selectionStart = startPos + myValue.length;
					myField.selectionEnd = startPos + myValue.length;
				} else {
					myField.value += myValue;
					myField.focus();
				}
			}
		}
	</script>
	<script>
			$(function() {
			var upload_url = getUploadUrl();
			var jsessionid = $("#sessionId").val();
			if (jsessionid) {
				upload_url += ";jsessionid=" + jsessionid;
			}
			var fileSizeLimit = "2GB";
			$('#imgUpload').uploadify({
				'queueID':'uploadProgressWrap',
			    'swf': '${base}/thirdparty/uploadify/uploadify.swf',	//指定上传控件的主体文件
			    'uploader': upload_url,	//指定服务器端上传处理文件
			    'auto':true,
			    'multi':true,
			    'buttonCursor':'hand',
			    'fileObjName':'Filedata',
			    'formData':{ 'fileType': 'interactImage' },
			    'fileSizeLimit':20480,
			    'fileTypeExts':"*.jpg;*.png",
			    'width' : 20,
				'height' : 20,
				'buttonText':'',
				'removeCompleted':true,
				'removeTimeout':1,
				'itemTemplate':'',
				'onUploadSuccess' : function(file, data, response) {
					$("#msgType").val(2);
					$('#audioDiv').hide();
					$('#videoDiv').hide();
					$('#textContent1').hide();
					$('#Imginput_Box').show();
					$('#Video_Box').hide();
					$('#Audio_Box').hide();
			    	$('#Content').hide();
					var jsonObj = eval('(' + data + ')');
					var filePath =  jsonObj.filePath;
					var thumbImgFilePath =  jsonObj.thumbImgFilePath;
					var fileRootUrl =  jsonObj.fileRootUrl;
					var uploadServerId = jsonObj.uploadServerId;
					var width = jsonObj.width;
					var height = jsonObj.height;
					var imageHtml = "";
					imageHtml += "<dd class=\"pull-left\" width=\"86\" height=\"86\" align=\"center\">";
					imageHtml += "<a title=\"photo by xixi\" rel=\"lightbox\" href=\"javascript:void(0)\">";
					imageHtml += "<img width=\"60\" height=\"60\" border=\"0\" src=\""+fileRootUrl +filePath+"\"/>";
					imageHtml += "<input class=\"imgContent\" type=\"hidden\" name=\"imgContent\" value=\""+fileRootUrl +filePath+"\">";
					imageHtml += "</a>";
					imageHtml += "<div class=\"del icon-remove-sign deleteImgButton\"></div>";
					imageHtml += "</dd>";
					$("#Imginput_Box dl").append(imageHtml);
			    },
			    'onUploadStart':function(d){
			    	console.log(d);
			    	
			    },
			    'onSelect':function(){
			    },
			    'onInit':function(){
					$("#imgUpload-button").attr("class","uploadify-button");
					$("#imgUpload-button").css({"background":"url('${base}/res/bvRadio/img/tupian.png') no-repeat","background-size":"100% 100%","width":"29px","height":"29px"})
			    },
			    'onUploadError':function(e,i,h){
			    	console.log("error");
			    	console.log(e);
			    	console.log(i);
			    	console.log(h);
			    	console.log("error22");
			    }
			});
			$(document).on("click",".deleteImgButton",function(){
				$(this).parent().remove();
				var imagesWarp = $("#Imginput_Box dl dd");
				if(imagesWarp.length<=0){
				$("#msgType").val(1);
				$("#textContent1").val("");
			 	$("#Imginput_Box dl").html("");
			 	$("#Audio_Box dl").html("");
			 	$("#Video_Box dl").html("");
			 	$('#Content').show();
				$('#Imginput_Box').hide();
				$('#Video_Box').hide();
				$('#Audio_Box').hide();
				$('#Imginput_Box').hide();
			    $('#Content').hide();
					$('#width').val("");
					$('#height').val("");
					$('#width').removeAttr("value");
					$('#height').removeAttr("value");
				}
			});
		}); 
	
	
	</script>
	    <script>
    $(".nav-left>li").each(function(i,v){
   		if($(v).find("li").hasClass("active")){
   			$(v).addClass("active").addClass("bigactive");
   		}
   })
    $(".nav-left li").each(function(a,b){	
     var location = window.location.pathname;
     	
     		if($(b).find("a").attr("href")==location){
     			$(b).addClass("active")
     		}
     })
    </script>
        <script>
   $(".nav-left>li").each(function(i,v){
   		if($(v).find("li").hasClass("active")){
   			$(v).addClass("active").addClass("bigactive");
   		}
   })
    $(".nav-left li").each(function(a,b){	
     var location = window.location.pathname;
     	
     		if($(b).find("a").attr("href")==location){
     			$(b).addClass("active")
     		}
     }) 
    	
    </script>
	<!-- 遮罩层开始 -->
	<div class='modal fade' id='modal-wrap' role='dialog'
		tabindex='-1' style="text-align:center;margin:0 auto;width:1300px;height:600px;" >
		<div class='modal-header'>
			
	
		</div>
		<iframe id="modelFrame" src="" frameborder="0" scrolling="auto"
			style="width:100%; height: 100%; overflow-x:auto;" ></iframe>
	</div>
	<!-- 遮罩层结束 -->
	<hr />

</html>