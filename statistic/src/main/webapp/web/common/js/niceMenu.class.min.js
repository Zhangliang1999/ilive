/**
 * nice Menu vs 1.0 ----------------
 * 
 * author: Andrei Dinca email: andrei.webdeveloper@gmail.com
 * 
 * version 1.0 release date: 1.11.2010
 * 
 */
var niceMenu = {
	o : {
		element : "",
		hideStep : 199,
		duration : 200,
		nextIcon : "images/niceMenu/menu_arraw.png",
		backBtn : "a#niceMenu-backBtn",
		lastId : 0,
		lastelm : 0,
		currentStep : 0,
		running : false
	},
	option : {},
	init : function(opt) {
		var obj = this;
		option = $.extend({}, obj.o, opt);
		obj.initMenu();
		obj.observerClick();
	},
	initMenu : function() {
		var obj = this;
		$(option.element).css("height", $(option.element + " ul").first().height());
		$(option.element).first().find("ul").addClass("pos--1");
		$(option.element).first().find("li").each(function(_0xc763x4) {
			var subObj = $(this);
			subObj.find("ul").first().addClass("poz-" + _0xc763x4);
			if (subObj.find("ul").first().size() > 0) {
				subObj.find("a").first().css({
					backgroundImage : "url(" + option.nextIcon + ")",
					backgroundRepeat : "no-repeat",
					backgroundPosition : "170px 5px"
				}).addClass("haveSubItem");
				subObj.find("a").first().next("ul").css("opacity", 0).css("visibility", "hidden");
			}
		});
	},
	moveMenu : function(subObj, _0xc763x6) {
		var obj = this;
		if (!option.running) {
			option.running = true;
			if (_0xc763x6 == "next") {
				option.currentStep = parseInt($(option.element).scrollLeft()) + option.hideStep;
				$(option.element).animate({
					height : subObj.next("ul").height()
				}, option.duration);
				option.lastId = subObj.parents("ul").attr("class");
				option.lastElm = subObj.next("ul");
				subObj.next("ul").css("visibility", "visible").animate({
					opacity : 1
				});
			} else {
				option.currentStep = parseInt($(option.element).scrollLeft()) - option.hideStep;
				$(option.element).animate({
					height : $("ul." + option.lastId).height()
				}, option.duration, function() {
					option.lastId = $(this).attr("class");
					option.lastElm.animate({
						opacity : 0
					}, option.duration / 2).css("visibility", "hidden");
				});
			}
			$(option.element).animate({
				scrollLeft : option.currentStep
			}, option.duration, function() {
				if ($(option.element).scrollLeft() > 0) {
					$(option.backBtn).animate({
						left : "-50px"
					}, option.duration, function() {
						$(this).css("z-index", 1);
						option.running = false;
					});
					$(option.backBtn).click(function() {
						obj.moveMenu($(this), "prev");
					});
				} else {
					if (option.currentStep <= 0) {
						$(option.backBtn).css("z-index", -1).animate({
							left : "0px"
						}, option.duration, function() {
							option.running = false;
						});
					}
				}
			});
		}
	},
	observerClick : function() {
		var obj = this;
		$(option.element + " ul a.haveSubItem").click(function() {
			obj.moveMenu($(this), "next");
		});
	}
};